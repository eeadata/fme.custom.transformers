#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN TableauPublishDatasource,1,"Web Services",00abfcdb-d48b-4621-89c4-26e495365f4e,"Linked by Default",No,NO_PARALLELISM,,No,16674,YES,No
# <p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
#     <span style=" font-family:'Arial'; color:#333333;">Publishes a tableau datasource on the specified site. </span>
# </p>
# 
# TRANSFORMER_END
#!   MAX_LOOP_ITERATIONS=""
#!   ATTR_TYPE_ENCODING="SDF"
#!   SHOW_INFO_NODES="true"
#!   USAGE="&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;Parameters:&lt;/span&gt;&#10;&lt;/p&gt;&#10;&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;&quot;&gt;&#10;    &lt;li style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Tableau Server: &lt;/li&gt;&#10;    &lt;li style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Token: The login token aquired by logging in to Tableau (transformer TableauLogin) &lt;/li&gt;&#10;    &lt;li style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Site Id: The site id aquired by logging in to Tableau (transformer TableauLogin) &lt;/li&gt;&#10;    &lt;li style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Project Id: The uuid of the project you wish to publish to (can be retrieved using Transformer TableauQueryProjects)&lt;/li&gt;&#10;    &lt;li style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Datasource Name: The display name you wish for your datasource &lt;/li&gt;&#10;    &lt;li style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Workbook Filepath: Filepath to the .tde, .tds or .tdsx&lt;/li&gt;&#10;&lt;/ul&gt;&#10;&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;Result: &lt;/span&gt;New attribute &quot;_datasource_id&quot; - the id that Tableau Server assigned to the uploaded datasource. &lt;/p&gt;&#10;"
#!   SHOW_ANNOTATIONS="true"
#!   ITERATION_COUNT_ATTR=""
#!   WORKSPACE_VERSION="1"
#!   REQUIREMENTS_KEYWORD="none"
#!   LAST_SAVE_BUILD="FME(R) 2016.1.2.1 (20160929 - Build 16674 - WIN64)"
#!   FME_BUILD_NUM="16674"
#!   LEGAL_TERMS_CONDITIONS="&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;"
#!   PASSWORD=""
#!   FME_PROCESS_GROUP_BY=""
#!   XFORM_DEPRECATED="No"
#!   REQUIREMENTS="&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   FME_SERVER_SERVICES=""
#!   FME_DOCUMENT_GUID="00abfcdb-d48b-4621-89c4-26e495365f4e"
#!   HISTORY="2016-11-07,Peter&lt;space&gt;Segerstedt,Initial&lt;space&gt;definition"
#!   FME_DOCUMENT_PRIORGUID="081fb1ff-6de9-4bd6-8600-91f87804fd21"
#!   DESCRIPTION="&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-family:&apos;Arial&apos;; color:#333333;&quot;&gt;Publishes a tableau datasource on the specified site. &lt;/span&gt;&#10;&lt;/p&gt;&#10;"
#!   LAST_SAVE_DATE="2016-11-07T15:05:49"
#!   BLOCKED_LOOPING="No"
#!   FMX_INSERT_MODE="Linked by Default"
#!   ZOOM_SCALE="100"
#!   TITLE="TableauPublishDatasource"
#!   DOC_TOP_LEFT="-2296.77 2622.15"
#!   FME_LINKED_TRANSFORMER_VERSION="1"
#!   VIEW_POSITION="-2493.77 3512.54"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   DOC_EXTENTS="2857.02 206.252"
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   CATEGORY="Web Services"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI URL_OR_ATTR SERVER HTTPS Tableau Server:"
#!   DEFAULT_VALUE="https://tableau.discomap.eea.europa.eu"
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_OR_ATTR_ENCODED TOKEN Token:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_OR_ATTR_ENCODED SITE_ID Site Id:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_OR_ATTR_ENCODED PROJECT_ID Project Id:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_OR_ATTR_ENCODED DATASOURCE_NAME Datasource Name:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI FILENAME_MUSTEXIST_OR_ATTR DATASOURCE_FILEPATH Tableau_Datasource_Files|*.tds_*.tdsx_*.tde|All_Files|*.* Datasource Filepath:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="1"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="-1163.51 2828.4"
#!   BOUNDING_RECT="-1163.51 2828.4 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16674"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_server" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_site_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_project_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_filepath" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_datasource_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_error" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="TableauPublisher"/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="PythonCaller"/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="_tableau_publish_error"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="#&lt;space&gt;Contains&lt;space&gt;methods&lt;space&gt;used&lt;space&gt;to&lt;space&gt;build&lt;space&gt;and&lt;space&gt;parse&lt;space&gt;XML&lt;lf&gt;import&lt;space&gt;xml.etree.ElementTree&lt;space&gt;as&lt;space&gt;ET&lt;lf&gt;import&lt;space&gt;requests&lt;space&gt;&lt;space&gt;#&lt;space&gt;Contains&lt;space&gt;methods&lt;space&gt;used&lt;space&gt;to&lt;space&gt;make&lt;space&gt;HTTP&lt;space&gt;requests&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;The&lt;space&gt;following&lt;space&gt;packages&lt;space&gt;are&lt;space&gt;used&lt;space&gt;to&lt;space&gt;build&lt;space&gt;a&lt;space&gt;multi-part&lt;solidus&gt;mixed&lt;space&gt;request.&lt;lf&gt;#&lt;space&gt;They&lt;space&gt;are&lt;space&gt;contained&lt;space&gt;in&lt;space&gt;the&lt;space&gt;&lt;apos&gt;requests&lt;apos&gt;&lt;space&gt;library.&lt;lf&gt;from&lt;space&gt;requests.packages.urllib3.fields&lt;space&gt;import&lt;space&gt;RequestField&lt;lf&gt;from&lt;space&gt;requests.packages.urllib3.filepost&lt;space&gt;import&lt;space&gt;encode_multipart_formdata&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;The&lt;space&gt;namespace&lt;space&gt;for&lt;space&gt;the&lt;space&gt;REST&lt;space&gt;API&lt;space&gt;is&lt;space&gt;&lt;apos&gt;http:&lt;solidus&gt;&lt;solidus&gt;tableausoftware.com&lt;solidus&gt;api&lt;apos&gt;&lt;space&gt;for&lt;space&gt;Tableau&lt;space&gt;Server&lt;space&gt;9.0&lt;space&gt;or&lt;space&gt;&lt;apos&gt;http:&lt;solidus&gt;&lt;solidus&gt;tableau.com&lt;solidus&gt;api&lt;apos&gt;&lt;space&gt;for&lt;space&gt;Tableau&lt;space&gt;Server&lt;space&gt;9.1&lt;space&gt;or&lt;space&gt;later&lt;space&gt;&lt;lf&gt;TABLEAU_NS_MAP&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;t&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;http:&lt;solidus&gt;&lt;solidus&gt;tableau.com&lt;solidus&gt;api&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;MAX_SINGLE_UPLOAD_SIZE&lt;space&gt;=&lt;space&gt;64&lt;space&gt;*&lt;space&gt;1024&lt;space&gt;*&lt;space&gt;1024&lt;lf&gt;CHUNK_UPLOAD_SIZE&lt;space&gt;=&lt;space&gt;64&lt;space&gt;*&lt;space&gt;1024&lt;space&gt;*&lt;space&gt;1024&lt;lf&gt;&lt;lf&gt;####&lt;lf&gt;#&lt;space&gt;Functions&lt;space&gt;for&lt;space&gt;constructing&lt;space&gt;HTTP&lt;space&gt;multi-part&lt;space&gt;requests&lt;space&gt;and&lt;space&gt;dealing&lt;space&gt;with&lt;space&gt;errors&lt;lf&gt;####&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;_make_multipart&lt;openparen&gt;parts&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Creates&lt;space&gt;one&lt;space&gt;&lt;quote&gt;chunk&lt;quote&gt;&lt;space&gt;for&lt;space&gt;a&lt;space&gt;multi-part&lt;space&gt;upload.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;parts&lt;apos&gt;&lt;space&gt;is&lt;space&gt;a&lt;space&gt;dictionary&lt;space&gt;that&lt;space&gt;provides&lt;space&gt;key-value&lt;space&gt;pairs&lt;space&gt;of&lt;space&gt;the&lt;space&gt;format&lt;space&gt;name:&lt;space&gt;&lt;openparen&gt;filename&lt;comma&gt;&lt;space&gt;body&lt;comma&gt;&lt;space&gt;content_type&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Returns&lt;space&gt;the&lt;space&gt;post&lt;space&gt;body&lt;space&gt;and&lt;space&gt;the&lt;space&gt;content&lt;space&gt;type&lt;space&gt;string.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;For&lt;space&gt;more&lt;space&gt;information&lt;comma&gt;&lt;space&gt;see&lt;space&gt;this&lt;space&gt;post:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;http:&lt;solidus&gt;&lt;solidus&gt;stackoverflow.com&lt;solidus&gt;questions&lt;solidus&gt;26299889&lt;solidus&gt;how-to-post-multipart-list-of-json-xml-files-using-python-requests&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;mime_multipart_parts&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;name&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;filename&lt;comma&gt;&lt;space&gt;blob&lt;comma&gt;&lt;space&gt;content_type&lt;closeparen&gt;&lt;space&gt;in&lt;space&gt;parts.items&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;multipart_part&lt;space&gt;=&lt;space&gt;RequestField&lt;openparen&gt;name=name&lt;comma&gt;&lt;space&gt;data=blob&lt;comma&gt;&lt;space&gt;filename=filename&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;multipart_part.make_multipart&lt;openparen&gt;content_type=content_type&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;mime_multipart_parts.append&lt;openparen&gt;multipart_part&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;post_body&lt;comma&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;encode_multipart_formdata&lt;openparen&gt;mime_multipart_parts&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openparen&gt;&lt;apos&gt;multipart&lt;solidus&gt;mixed&lt;apos&gt;&lt;comma&gt;&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;content_type.partition&lt;openparen&gt;&lt;apos&gt;&lt;semicolon&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;openbracket&gt;1:&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;post_body&lt;comma&gt;&lt;space&gt;content_type&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;TableauServer&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;server&lt;comma&gt;&lt;space&gt;site_name&lt;comma&gt;&lt;space&gt;site_id=None&lt;comma&gt;&lt;space&gt;signout_on_exit=True&lt;comma&gt;&lt;space&gt;token=None&lt;comma&gt;&lt;space&gt;user_id=None&lt;comma&gt;&lt;space&gt;fout=sys.stdout&lt;comma&gt;&lt;space&gt;ferr=sys.stderr&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.server&lt;space&gt;=&lt;space&gt;server.strip&lt;openparen&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.site&lt;space&gt;=&lt;space&gt;site_name&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.signout_on_exit&lt;space&gt;=&lt;space&gt;signout_on_exit&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.site_id&lt;space&gt;=&lt;space&gt;site_id&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.token&lt;space&gt;=&lt;space&gt;token&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.user_id&lt;space&gt;=&lt;space&gt;user_id&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self._debug&lt;space&gt;=&lt;space&gt;True&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self._fout&lt;space&gt;=&lt;space&gt;fout&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self._ferr&lt;space&gt;=&lt;space&gt;ferr&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;&lt;apos&gt;Initialized&lt;space&gt;TableauServer&lt;space&gt;API&lt;space&gt;object&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__enter__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;self&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__exit__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;t&lt;comma&gt;&lt;space&gt;value&lt;comma&gt;&lt;space&gt;traceback&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.token&lt;space&gt;and&lt;space&gt;self.signout_on_exit:&lt;space&gt;return&lt;space&gt;self.signout&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;200&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;isinstance&lt;openparen&gt;value&lt;comma&gt;&lt;space&gt;TypeError&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__debug&lt;openparen&gt;self&lt;comma&gt;msg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self._debug&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self._fout.write&lt;openparen&gt;&lt;apos&gt;DEBUG:&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;backslash&gt;n&lt;apos&gt;.format&lt;openparen&gt;msg&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;sign_in&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;username&lt;comma&gt;&lt;space&gt;password&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.token:&lt;space&gt;self.signout&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;auth&lt;solidus&gt;signin&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;url&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Builds&lt;space&gt;the&lt;space&gt;request&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.Element&lt;openparen&gt;&lt;apos&gt;tsRequest&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;credentials_element&lt;space&gt;=&lt;space&gt;ET.SubElement&lt;openparen&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;credentials&lt;apos&gt;&lt;comma&gt;&lt;space&gt;name=username&lt;comma&gt;&lt;space&gt;password=password&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ET.SubElement&lt;openparen&gt;credentials_element&lt;comma&gt;&lt;space&gt;&lt;apos&gt;site&lt;apos&gt;&lt;comma&gt;&lt;space&gt;contentUrl=self.site&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.tostring&lt;openparen&gt;xml_payload_for_request&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#xml_payload_for_request&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;lt&gt;tsRequest&lt;gt&gt;&lt;lt&gt;credentials&lt;space&gt;name=&lt;quote&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;quote&gt;&lt;space&gt;password=&lt;quote&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;quote&gt;&lt;gt&gt;&lt;lt&gt;site&lt;space&gt;contentUrl=&lt;quote&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;quote&gt;&lt;solidus&gt;&lt;gt&gt;&lt;lt&gt;&lt;solidus&gt;credentials&lt;gt&gt;&lt;lt&gt;&lt;solidus&gt;tsRequest&lt;gt&gt;&lt;apos&gt;.format&lt;openparen&gt;username&lt;comma&gt;&lt;space&gt;password&lt;comma&gt;&lt;space&gt;self.site_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;xml_payload_for_request&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Makes&lt;space&gt;the&lt;space&gt;request&lt;space&gt;to&lt;space&gt;Tableau&lt;space&gt;Server&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.post&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;data=xml_payload_for_request&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;200:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Reads&lt;space&gt;and&lt;space&gt;parses&lt;space&gt;the&lt;space&gt;response&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Gets&lt;space&gt;the&lt;space&gt;token&lt;space&gt;and&lt;space&gt;site&lt;space&gt;ID&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.token&lt;space&gt;=&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:credentials&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.attrib.get&lt;openparen&gt;&lt;apos&gt;token&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.site_id&lt;space&gt;=&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;.&lt;solidus&gt;&lt;solidus&gt;t:site&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.attrib.get&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.user_id&lt;space&gt;=&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;.&lt;solidus&gt;&lt;solidus&gt;t:user&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.attrib.get&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;self&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;signout&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;&lt;apos&gt;signout&lt;comma&gt;&lt;space&gt;token=&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;.format&lt;openparen&gt;self.token&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;not&lt;space&gt;self.token:&lt;space&gt;return&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;auth&lt;solidus&gt;signout&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;space&gt;=&lt;space&gt;requests.post&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;apos&gt;x-tableau-auth&lt;apos&gt;:&lt;space&gt;self.token&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.token&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;r.status_code&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;start_upload_session&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Creates&lt;space&gt;a&lt;space&gt;POST&lt;space&gt;request&lt;space&gt;that&lt;space&gt;initiates&lt;space&gt;a&lt;space&gt;file&lt;space&gt;upload&lt;space&gt;session.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Returns&lt;space&gt;a&lt;space&gt;session&lt;space&gt;ID&lt;space&gt;that&lt;space&gt;is&lt;space&gt;used&lt;space&gt;by&lt;space&gt;subsequent&lt;space&gt;functions&lt;space&gt;to&lt;space&gt;identify&lt;space&gt;the&lt;space&gt;upload&lt;space&gt;session.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;fileUploads&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.post&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;quote&gt;x-tableau-auth&lt;quote&gt;:&lt;space&gt;self.token&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;201:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:fileUpload&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.attrib.get&lt;openparen&gt;&lt;apos&gt;uploadSessionId&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__publish_chunked&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;filepath&lt;comma&gt;&lt;space&gt;workbook_name&lt;comma&gt;&lt;space&gt;project_id&lt;comma&gt;&lt;space&gt;chunk_size&lt;space&gt;=&lt;space&gt;CHUNK_UPLOAD_SIZE&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Publishes&lt;space&gt;a&lt;space&gt;file&lt;space&gt;to&lt;space&gt;Tableau&lt;space&gt;Server&lt;space&gt;in&lt;space&gt;chunks.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;filepath&lt;apos&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;name&lt;space&gt;of&lt;space&gt;the&lt;space&gt;file&lt;space&gt;to&lt;space&gt;publish.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;workbook_name&lt;apos&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;workbook&lt;space&gt;name&lt;space&gt;as&lt;space&gt;a&lt;space&gt;string.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;project_id&lt;apos&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;&lt;openparen&gt;as&lt;space&gt;a&lt;space&gt;string&lt;closeparen&gt;&lt;space&gt;of&lt;space&gt;the&lt;space&gt;project&lt;space&gt;to&lt;space&gt;publish&lt;space&gt;to.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Returns&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;of&lt;space&gt;the&lt;space&gt;published&lt;space&gt;workbbok.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Initiates&lt;space&gt;an&lt;space&gt;upload&lt;space&gt;session&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;uploadID&lt;space&gt;=&lt;space&gt;self.start_upload_session&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Reads&lt;space&gt;the&lt;space&gt;source&lt;space&gt;file&lt;space&gt;in&lt;space&gt;chunks&lt;space&gt;&lt;openparen&gt;default&lt;space&gt;is&lt;space&gt;100KB&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;with&lt;space&gt;open&lt;openparen&gt;filepath&lt;comma&gt;&lt;space&gt;&lt;apos&gt;rb&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;as&lt;space&gt;fin:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;read_chunk&lt;openparen&gt;&lt;closeparen&gt;:&lt;space&gt;return&lt;space&gt;fin.read&lt;openparen&gt;chunk_size&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;fileUploads&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;comma&gt;&lt;space&gt;uploadID&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;data&lt;space&gt;in&lt;space&gt;iter&lt;openparen&gt;read_chunk&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;closeparen&gt;:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;payload&lt;comma&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;_make_multipart&lt;openparen&gt;&lt;opencurly&gt;&lt;apos&gt;request_payload&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;b&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;text&lt;solidus&gt;xml&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tableau_file&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;file&lt;apos&gt;&lt;comma&gt;&lt;space&gt;data&lt;comma&gt;&lt;space&gt;&lt;apos&gt;application&lt;solidus&gt;octet-stream&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;space&gt;=&lt;space&gt;requests.put&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;data=payload&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;quote&gt;x-tableau-auth&lt;quote&gt;:&lt;space&gt;self.token&lt;comma&gt;&lt;space&gt;&lt;quote&gt;content-type&lt;quote&gt;:&lt;space&gt;content_type&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;&lt;apos&gt;Uploaded&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;space&gt;bytes&lt;comma&gt;&lt;space&gt;status&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;.format&lt;openparen&gt;len&lt;openparen&gt;data&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;r.status_code&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;basename&lt;space&gt;is&lt;space&gt;not&lt;space&gt;used&lt;space&gt;when&lt;space&gt;uploading&lt;space&gt;in&lt;space&gt;chunks&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;basename&lt;space&gt;=&lt;space&gt;os.path.basename&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;file_ext&lt;space&gt;=&lt;space&gt;os.path.splitext&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;openbracket&gt;1&lt;closebracket&gt;.strip&lt;openparen&gt;&lt;apos&gt;.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Builds&lt;space&gt;a&lt;space&gt;request&lt;space&gt;for&lt;space&gt;publishing&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.Element&lt;openparen&gt;&lt;apos&gt;tsRequest&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;workbook_element&lt;space&gt;=&lt;space&gt;ET.SubElement&lt;openparen&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;workbook&lt;apos&gt;&lt;comma&gt;&lt;space&gt;name=workbook_name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ET.SubElement&lt;openparen&gt;workbook_element&lt;comma&gt;&lt;space&gt;&lt;apos&gt;project&lt;apos&gt;&lt;comma&gt;&lt;space&gt;id=project_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.tostring&lt;openparen&gt;xml_payload_for_request&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;payload&lt;comma&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;_make_multipart&lt;openparen&gt;&lt;opencurly&gt;&lt;apos&gt;request_payload&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;text&lt;solidus&gt;xml&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;workbooks?uploadSessionId=&lt;opencurly&gt;&lt;closecurly&gt;&lt;amp&gt;workbookType=&lt;opencurly&gt;&lt;closecurly&gt;&lt;amp&gt;overwrite=true&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;comma&gt;&lt;space&gt;uploadID&lt;comma&gt;&lt;space&gt;file_ext&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;url&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.post&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;data=payload&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;apos&gt;x-tableau-auth&lt;apos&gt;:&lt;space&gt;self.token&lt;comma&gt;&lt;space&gt;&lt;apos&gt;content-type&lt;apos&gt;:&lt;space&gt;content_type&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;201:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:workbook&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.get&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__publish_ds_chunked&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;filepath&lt;comma&gt;&lt;space&gt;datasource_name&lt;comma&gt;&lt;space&gt;project_id&lt;comma&gt;&lt;space&gt;chunk_size&lt;space&gt;=&lt;space&gt;CHUNK_UPLOAD_SIZE&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Publishes&lt;space&gt;a&lt;space&gt;file&lt;space&gt;to&lt;space&gt;Tableau&lt;space&gt;Server&lt;space&gt;in&lt;space&gt;chunks.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;filepath&lt;apos&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;name&lt;space&gt;of&lt;space&gt;the&lt;space&gt;file&lt;space&gt;to&lt;space&gt;publish.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;datasource_name&lt;apos&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;data&lt;space&gt;source&lt;space&gt;as&lt;space&gt;a&lt;space&gt;string.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;project_id&lt;apos&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;&lt;openparen&gt;as&lt;space&gt;a&lt;space&gt;string&lt;closeparen&gt;&lt;space&gt;of&lt;space&gt;the&lt;space&gt;project&lt;space&gt;to&lt;space&gt;publish&lt;space&gt;to.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Returns&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;of&lt;space&gt;the&lt;space&gt;published&lt;space&gt;data&lt;space&gt;source.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Initiates&lt;space&gt;an&lt;space&gt;upload&lt;space&gt;session&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;uploadID&lt;space&gt;=&lt;space&gt;self.start_upload_session&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Reads&lt;space&gt;the&lt;space&gt;source&lt;space&gt;file&lt;space&gt;in&lt;space&gt;chunks&lt;space&gt;&lt;openparen&gt;default&lt;space&gt;is&lt;space&gt;100KB&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;with&lt;space&gt;open&lt;openparen&gt;filepath&lt;comma&gt;&lt;space&gt;&lt;apos&gt;rb&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;as&lt;space&gt;fin:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;read_chunk&lt;openparen&gt;&lt;closeparen&gt;:&lt;space&gt;return&lt;space&gt;fin.read&lt;openparen&gt;chunk_size&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;fileUploads&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;comma&gt;&lt;space&gt;uploadID&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;data&lt;space&gt;in&lt;space&gt;iter&lt;openparen&gt;read_chunk&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;closeparen&gt;:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;payload&lt;comma&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;_make_multipart&lt;openparen&gt;&lt;opencurly&gt;&lt;apos&gt;request_payload&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;b&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;text&lt;solidus&gt;xml&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tableau_file&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;file&lt;apos&gt;&lt;comma&gt;&lt;space&gt;data&lt;comma&gt;&lt;space&gt;&lt;apos&gt;application&lt;solidus&gt;octet-stream&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;space&gt;=&lt;space&gt;requests.put&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;data=payload&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;quote&gt;x-tableau-auth&lt;quote&gt;:&lt;space&gt;self.token&lt;comma&gt;&lt;space&gt;&lt;quote&gt;content-type&lt;quote&gt;:&lt;space&gt;content_type&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;&lt;apos&gt;Uploaded&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;space&gt;bytes&lt;comma&gt;&lt;space&gt;status&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;.format&lt;openparen&gt;len&lt;openparen&gt;data&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;r.status_code&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;basename&lt;space&gt;is&lt;space&gt;not&lt;space&gt;used&lt;space&gt;when&lt;space&gt;uploading&lt;space&gt;in&lt;space&gt;chunks&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;basename&lt;space&gt;=&lt;space&gt;os.path.basename&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;file_ext&lt;space&gt;=&lt;space&gt;os.path.splitext&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;openbracket&gt;1&lt;closebracket&gt;.strip&lt;openparen&gt;&lt;apos&gt;.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Builds&lt;space&gt;a&lt;space&gt;request&lt;space&gt;for&lt;space&gt;publishing&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.Element&lt;openparen&gt;&lt;apos&gt;tsRequest&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datasource_element&lt;space&gt;=&lt;space&gt;ET.SubElement&lt;openparen&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;datasource&lt;apos&gt;&lt;comma&gt;&lt;space&gt;name=datasource_name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ET.SubElement&lt;openparen&gt;datasource_element&lt;comma&gt;&lt;space&gt;&lt;apos&gt;project&lt;apos&gt;&lt;comma&gt;&lt;space&gt;id=project_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.tostring&lt;openparen&gt;xml_payload_for_request&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;payload&lt;comma&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;_make_multipart&lt;openparen&gt;&lt;opencurly&gt;&lt;apos&gt;request_payload&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;text&lt;solidus&gt;xml&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;datasources?uploadSessionId=&lt;opencurly&gt;&lt;closecurly&gt;&lt;amp&gt;datasourceType=&lt;opencurly&gt;&lt;closecurly&gt;&lt;amp&gt;overwrite=true&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;comma&gt;&lt;space&gt;uploadID&lt;comma&gt;&lt;space&gt;file_ext&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;url&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.post&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;data=payload&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;apos&gt;x-tableau-auth&lt;apos&gt;:&lt;space&gt;self.token&lt;comma&gt;&lt;space&gt;&lt;apos&gt;content-type&lt;apos&gt;:&lt;space&gt;content_type&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;201:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:datasource&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.get&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;publish_datasource&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;filepath&lt;comma&gt;&lt;space&gt;datasource_name&lt;comma&gt;&lt;space&gt;project_id&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Publishes&lt;space&gt;a&lt;space&gt;file&lt;space&gt;to&lt;space&gt;Tableau&lt;space&gt;Server&lt;space&gt;in&lt;space&gt;a&lt;space&gt;single&lt;space&gt;request.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;filepath&lt;apos&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;path&lt;space&gt;of&lt;space&gt;the&lt;space&gt;file&lt;space&gt;to&lt;space&gt;publish.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;datasource_name&lt;apos&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;data&lt;space&gt;source&lt;space&gt;name&lt;space&gt;as&lt;space&gt;a&lt;space&gt;string.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;project_id&lt;apos&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;&lt;openparen&gt;as&lt;space&gt;a&lt;space&gt;string&lt;closeparen&gt;&lt;space&gt;of&lt;space&gt;the&lt;space&gt;project&lt;space&gt;to&lt;space&gt;publish&lt;space&gt;to.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Returns&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;of&lt;space&gt;the&lt;space&gt;published&lt;space&gt;data&lt;space&gt;source.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;with&lt;space&gt;open&lt;openparen&gt;filepath&lt;comma&gt;&lt;space&gt;&lt;apos&gt;rb&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;as&lt;space&gt;f:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;old_file_position&lt;space&gt;=&lt;space&gt;f.tell&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;f.seek&lt;openparen&gt;0&lt;comma&gt;&lt;space&gt;os.SEEK_END&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;size&lt;space&gt;=&lt;space&gt;f.tell&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;size&lt;space&gt;&lt;gt&gt;&lt;space&gt;MAX_SINGLE_UPLOAD_SIZE:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;f.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;self.__publish_ds_chunked&lt;openparen&gt;filepath&lt;comma&gt;&lt;space&gt;datasource_name&lt;comma&gt;&lt;space&gt;project_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;f.seek&lt;openparen&gt;old_file_position&lt;comma&gt;&lt;space&gt;os.SEEK_SET&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datasource_bytes&lt;space&gt;=&lt;space&gt;f.read&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;basename&lt;space&gt;=&lt;space&gt;os.path.basename&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;file_ext&lt;space&gt;=&lt;space&gt;os.path.splitext&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;openbracket&gt;1&lt;closebracket&gt;.strip&lt;openparen&gt;&lt;apos&gt;.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Builds&lt;space&gt;the&lt;space&gt;publish&lt;space&gt;request&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.Element&lt;openparen&gt;&lt;apos&gt;tsRequest&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datasource_element&lt;space&gt;=&lt;space&gt;ET.SubElement&lt;openparen&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;datasource&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;name=datasource_name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ET.SubElement&lt;openparen&gt;datasource_element&lt;comma&gt;&lt;space&gt;&lt;apos&gt;project&lt;apos&gt;&lt;comma&gt;&lt;space&gt;id=project_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.tostring&lt;openparen&gt;xml_payload_for_request&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;payload&lt;comma&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;_make_multipart&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;request_payload&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;text&lt;solidus&gt;xml&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tableau_datasource&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;basename&lt;comma&gt;&lt;space&gt;datasource_bytes&lt;comma&gt;&lt;space&gt;&lt;apos&gt;application&lt;solidus&gt;octet-stream&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;datasources?overwrite=true&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;url&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.post&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;data=payload&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;apos&gt;x-tableau-auth&lt;apos&gt;:&lt;space&gt;self.token&lt;comma&gt;&lt;space&gt;&lt;apos&gt;content-type&lt;apos&gt;:&lt;space&gt;content_type&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;201:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:datasource&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.get&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;publish_workbook&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;filepath&lt;comma&gt;&lt;space&gt;workbook_name&lt;comma&gt;&lt;space&gt;project_id&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Publishes&lt;space&gt;a&lt;space&gt;file&lt;space&gt;to&lt;space&gt;Tableau&lt;space&gt;Server&lt;space&gt;in&lt;space&gt;a&lt;space&gt;single&lt;space&gt;request.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;filepath&lt;apos&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;path&lt;space&gt;of&lt;space&gt;the&lt;space&gt;file&lt;space&gt;to&lt;space&gt;publish.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;workbook_name&lt;apos&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;workbook&lt;space&gt;name&lt;space&gt;as&lt;space&gt;a&lt;space&gt;string.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;project_id&lt;apos&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;&lt;openparen&gt;as&lt;space&gt;a&lt;space&gt;string&lt;closeparen&gt;&lt;space&gt;of&lt;space&gt;the&lt;space&gt;project&lt;space&gt;to&lt;space&gt;publish&lt;space&gt;to.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Returns&lt;space&gt;the&lt;space&gt;ID&lt;space&gt;of&lt;space&gt;the&lt;space&gt;published&lt;space&gt;workbook.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;with&lt;space&gt;open&lt;openparen&gt;filepath&lt;comma&gt;&lt;space&gt;&lt;apos&gt;rb&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;as&lt;space&gt;f:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;old_file_position&lt;space&gt;=&lt;space&gt;f.tell&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;f.seek&lt;openparen&gt;0&lt;comma&gt;&lt;space&gt;os.SEEK_END&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;size&lt;space&gt;=&lt;space&gt;f.tell&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;size&lt;space&gt;&lt;gt&gt;&lt;space&gt;MAX_SINGLE_UPLOAD_SIZE:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;f.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;self.__publish_chunked&lt;openparen&gt;filepath&lt;comma&gt;&lt;space&gt;workbook_name&lt;comma&gt;&lt;space&gt;project_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;f.seek&lt;openparen&gt;old_file_position&lt;comma&gt;&lt;space&gt;os.SEEK_SET&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;workbook_bytes&lt;space&gt;=&lt;space&gt;f.read&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;basename&lt;space&gt;=&lt;space&gt;os.path.basename&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;file_ext&lt;space&gt;=&lt;space&gt;os.path.splitext&lt;openparen&gt;filepath&lt;closeparen&gt;&lt;openbracket&gt;1&lt;closebracket&gt;.strip&lt;openparen&gt;&lt;apos&gt;.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Builds&lt;space&gt;the&lt;space&gt;publish&lt;space&gt;request&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.Element&lt;openparen&gt;&lt;apos&gt;tsRequest&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;workbook_element&lt;space&gt;=&lt;space&gt;ET.SubElement&lt;openparen&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;workbook&lt;apos&gt;&lt;comma&gt;&lt;space&gt;name=workbook_name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ET.SubElement&lt;openparen&gt;workbook_element&lt;comma&gt;&lt;space&gt;&lt;apos&gt;project&lt;apos&gt;&lt;comma&gt;&lt;space&gt;id=project_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_payload_for_request&lt;space&gt;=&lt;space&gt;ET.tostring&lt;openparen&gt;xml_payload_for_request&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;payload&lt;comma&gt;&lt;space&gt;content_type&lt;space&gt;=&lt;space&gt;_make_multipart&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;request_payload&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;xml_payload_for_request&lt;comma&gt;&lt;space&gt;&lt;apos&gt;text&lt;solidus&gt;xml&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tableau_workbook&lt;apos&gt;:&lt;space&gt;&lt;openparen&gt;basename&lt;comma&gt;&lt;space&gt;workbook_bytes&lt;comma&gt;&lt;space&gt;&lt;apos&gt;application&lt;solidus&gt;octet-stream&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;workbooks?workbookType=&lt;opencurly&gt;&lt;closecurly&gt;&lt;amp&gt;overwrite=true&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;comma&gt;&lt;space&gt;file_ext&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;url&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.post&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;data=payload&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;apos&gt;x-tableau-auth&lt;apos&gt;:&lt;space&gt;self.token&lt;comma&gt;&lt;space&gt;&lt;apos&gt;content-type&lt;apos&gt;:&lt;space&gt;content_type&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;201:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:workbook&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.get&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;query_projects&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Yields&lt;space&gt;tuples&lt;space&gt;of&lt;space&gt;&lt;openparen&gt;project_name&lt;comma&gt;&lt;space&gt;project_id&lt;closeparen&gt;&lt;space&gt;on&lt;space&gt;the&lt;space&gt;site.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;function&lt;space&gt;paginates&lt;space&gt;over&lt;space&gt;results&lt;space&gt;&lt;openparen&gt;if&lt;space&gt;required&lt;closeparen&gt;&lt;space&gt;using&lt;space&gt;a&lt;space&gt;page&lt;space&gt;size&lt;space&gt;of&lt;space&gt;100.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;not&lt;space&gt;self.token:&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;&lt;apos&gt;Not&lt;space&gt;signed&lt;space&gt;in&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;page_num&lt;comma&gt;&lt;space&gt;page_size&lt;space&gt;=&lt;space&gt;1&lt;comma&gt;&lt;space&gt;100&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;projects&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;count&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True&lt;space&gt;and&lt;space&gt;count&lt;space&gt;&lt;lt&gt;&lt;space&gt;1000:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;paged_url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;?pageSize=&lt;opencurly&gt;&lt;closecurly&gt;&lt;amp&gt;pageNumber=&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;.format&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;page_size&lt;comma&gt;&lt;space&gt;page_num&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;paged_url&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.get&lt;openparen&gt;paged_url&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;quote&gt;x-tableau-auth&lt;quote&gt;:&lt;space&gt;self.token&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response.encoding&lt;space&gt;=&lt;space&gt;&lt;quote&gt;utf-8&lt;quote&gt;&lt;semicolon&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;200:&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;total_count_of_projects&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:pagination&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.attrib.get&lt;openparen&gt;&lt;apos&gt;totalAvailable&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;project&lt;space&gt;in&lt;space&gt;xml_response.findall&lt;openparen&gt;&lt;apos&gt;.&lt;solidus&gt;&lt;solidus&gt;t:project&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;count&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;yield&lt;space&gt;project.get&lt;openparen&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;project.get&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;count&lt;space&gt;&lt;gt&gt;=&lt;space&gt;total_count_of_projects:&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;page_num&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;list_workbooks&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Returns&lt;space&gt;a&lt;space&gt;list&lt;space&gt;of&lt;space&gt;workbooks&lt;space&gt;that&lt;space&gt;the&lt;space&gt;current&lt;space&gt;user&lt;space&gt;has&lt;space&gt;permission&lt;space&gt;to&lt;space&gt;read&lt;space&gt;&lt;openparen&gt;a&lt;space&gt;list&lt;space&gt;of&lt;space&gt;&lt;lt&gt;workbook&lt;gt&gt;&lt;space&gt;elements&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;user_id&lt;apos&gt;&lt;space&gt;is&lt;space&gt;the&lt;space&gt;LUID&lt;space&gt;&lt;openparen&gt;as&lt;space&gt;a&lt;space&gt;string&lt;closeparen&gt;&lt;space&gt;of&lt;space&gt;the&lt;space&gt;user&lt;space&gt;to&lt;space&gt;get&lt;space&gt;workbooks&lt;space&gt;for.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;function&lt;space&gt;paginates&lt;space&gt;over&lt;space&gt;the&lt;space&gt;results&lt;space&gt;&lt;openparen&gt;if&lt;space&gt;required&lt;closeparen&gt;&lt;space&gt;using&lt;space&gt;a&lt;space&gt;page&lt;space&gt;size&lt;space&gt;of&lt;space&gt;100.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;page_num&lt;comma&gt;&lt;space&gt;page_size&lt;space&gt;=&lt;space&gt;1&lt;comma&gt;&lt;space&gt;100&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;users&lt;solidus&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;solidus&gt;workbooks&lt;apos&gt;.format&lt;openparen&gt;self.server&lt;comma&gt;&lt;space&gt;self.site_id&lt;comma&gt;&lt;space&gt;self.user_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;count&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True&lt;space&gt;and&lt;space&gt;count&lt;space&gt;&lt;lt&gt;&lt;space&gt;1000:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;paged_url&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;?pageSize=&lt;opencurly&gt;&lt;closecurly&gt;&lt;amp&gt;pageNumber=&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;.format&lt;openparen&gt;url&lt;comma&gt;&lt;space&gt;page_size&lt;comma&gt;&lt;space&gt;page_num&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_response&lt;space&gt;=&lt;space&gt;requests.get&lt;openparen&gt;paged_url&lt;comma&gt;&lt;space&gt;headers=&lt;opencurly&gt;&lt;quote&gt;x-tableau-auth&lt;quote&gt;:&lt;space&gt;self.token&lt;closecurly&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;server_response.status_code&lt;space&gt;!=&lt;space&gt;200:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;Exception&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__debug&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;xml_response&lt;space&gt;=&lt;space&gt;ET.fromstring&lt;openparen&gt;server_response.text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;total_count_of_workbooks&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;xml_response.find&lt;openparen&gt;&lt;apos&gt;t:pagination&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;.attrib.get&lt;openparen&gt;&lt;apos&gt;totalAvailable&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;workbook&lt;space&gt;in&lt;space&gt;xml_response.findall&lt;openparen&gt;&lt;apos&gt;.&lt;solidus&gt;&lt;solidus&gt;t:workbook&lt;apos&gt;&lt;comma&gt;&lt;space&gt;namespaces=TABLEAU_NS_MAP&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;count&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;yield&lt;space&gt;map&lt;openparen&gt;workbook.get&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;apos&gt;id&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;contentUrl&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;showTabs&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;count&lt;space&gt;&lt;gt&gt;=&lt;space&gt;total_count_of_workbooks:&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;page_num&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;LogWrapper&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;fmelog&lt;comma&gt;&lt;space&gt;fmt=&lt;apos&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;level=fmeobjects.FME_INFORM&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.fmelog&lt;space&gt;=&lt;space&gt;fmelog&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.fmt&lt;space&gt;=&lt;space&gt;fmt&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.level&lt;space&gt;=&lt;space&gt;level&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;write&lt;openparen&gt;self&lt;comma&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.fmelog.logMessageString&lt;openparen&gt;self.fmt.format&lt;openparen&gt;str.strip&lt;openparen&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;self.level&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;TableauPublisher&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.logwrapinfo&lt;space&gt;=&lt;space&gt;LogWrapper&lt;openparen&gt;self.logger&lt;comma&gt;&lt;space&gt;fmt=&lt;apos&gt;TableauPublisher:&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.logwraperror&lt;space&gt;=&lt;space&gt;LogWrapper&lt;openparen&gt;self.logger&lt;comma&gt;&lt;space&gt;fmt=&lt;apos&gt;TableauPublisher:&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;level=fmeobjects.FME_ERROR&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.logger.logMessageString&lt;openparen&gt;&lt;quote&gt;TableauPublisher&lt;space&gt;initialized&lt;quote&gt;&lt;comma&gt;&lt;space&gt;fmeobjects.FME_INFORM&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server_url&lt;comma&gt;&lt;space&gt;token&lt;comma&gt;&lt;space&gt;site_id&lt;comma&gt;&lt;space&gt;project_id&lt;comma&gt;&lt;space&gt;datasource_name&lt;comma&gt;&lt;space&gt;datasource_filepath&lt;space&gt;=&lt;space&gt;map&lt;openparen&gt;feature.getAttribute&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;_tableau_publish_server&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;_tableau_publish_token&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;_tableau_publish_site_id&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;_tableau_publish_project_id&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;_tableau_publish_datasource_name&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;_tableau_publish_datasource_filepath&lt;apos&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datasource_id_attr&lt;space&gt;=&lt;space&gt;&lt;apos&gt;_datasource_id&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;server&lt;space&gt;=&lt;space&gt;TableauServer&lt;openparen&gt;server_url&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;site_id=site_id&lt;comma&gt;&lt;space&gt;token=token&lt;comma&gt;&lt;space&gt;signout_on_exit=False&lt;comma&gt;fout=self.logwrapinfo&lt;comma&gt;&lt;space&gt;ferr=self.logwraperror&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datasource_id&lt;space&gt;=&lt;space&gt;server.publish_datasource&lt;openparen&gt;datasource_filepath&lt;comma&gt;&lt;space&gt;datasource_name&lt;comma&gt;&lt;space&gt;project_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;datasource_id_attr&lt;comma&gt;&lt;space&gt;datasource_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.logger.logException&lt;openparen&gt;e&lt;comma&gt;&lt;space&gt;fmeobjects.FME_ERROR&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;_tableau_publish_error&lt;apos&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;e&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.logger.logMessageString&lt;openparen&gt;&lt;quote&gt;TableauPublisher&lt;space&gt;closed&lt;quote&gt;&lt;comma&gt;&lt;space&gt;fmeobjects.FME_INFORM&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;del&lt;openparen&gt;self.logger&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Needed&lt;space&gt;to&lt;space&gt;avoid&lt;space&gt;&lt;quote&gt;Not&lt;space&gt;All&lt;space&gt;FME&lt;space&gt;sessions&lt;space&gt;were&lt;space&gt;destroyed&lt;quote&gt;"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="2"
#!   TYPE="AttributeCreator"
#!   VERSION="8"
#!   POSITION="-1682.7 2828.4"
#!   BOUNDING_RECT="-1682.7 2828.4 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16674"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_server" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_site_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_project_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_filepath" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_datasource_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AttributeCreator"/>
#!     <XFORM_PARM PARM_NAME="NULL_ATTR_VALUE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NUM_PRIOR_FEATURES" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="NUM_SUBSEQUENT_FEATURES" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="MULTI_FEATURE_MODE" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_TABLE" PARM_VALUE="&quot;&quot; _tableau_publish_server SET_TO $(SERVER)  _tableau_publish_token SET_TO $(TOKEN)  _tableau_publish_site_id SET_TO $(SITE_ID)  _tableau_publish_project_id SET_TO $(PROJECT_ID)  _tableau_publish_datasource_name SET_TO $(DATASOURCE_NAME)  _tableau_publish_datasource_filepath SET_TO $(DATASOURCE_FILEPATH)  _datasource_id SET_TO "/>
#!     <XFORM_PARM PARM_NAME="NULL_ATTR_MODE_DISPLAY" PARM_VALUE="No Substitution"/>
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_HANDLING" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="3"
#!   TYPE="AttributeRemover"
#!   VERSION="1"
#!   POSITION="14.6228 2828.4"
#!   BOUNDING_RECT="14.6228 2828.4 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16674"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="_datasource_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AttributeRemover"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="REMOVE_ATTRS" PARM_VALUE="_tableau_publish_datasource_name,_tableau_publish_error,_tableau_publish_project_id,_tableau_publish_site_id,_tableau_publish_datasource_filepath,_tableau_publish_token,_tableau_publish_server"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="Tester"
#!   VERSION="2"
#!   POSITION="-585.377 2828.4"
#!   BOUNDING_RECT="-585.377 2828.4 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16177"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_server" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_site_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_project_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_filepath" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_datasource_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_error" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_server" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_token" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_site_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_project_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_datasource_filepath" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_datasource_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_error" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="TEST_DESCRIPTION" PARM_VALUE="&quot;&quot;"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST _tableau_publish_error ATTRIBUTE_IS_MISSING &quot;&quot;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Tester"/>
#!     <XFORM_PARM PARM_NAME="TEST_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="Automatic"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="5"
#!   TYPE="AttributeRemover"
#!   VERSION="1"
#!   POSITION="14.6228 2622.15"
#!   BOUNDING_RECT="14.6228 2622.15 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16674"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="_tableau_publish_error" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AttributeRemover_2"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="REMOVE_ATTRS" PARM_VALUE="_tableau_publish_datasource_name,_datasource_id,_tableau_publish_project_id,_tableau_publish_site_id,_tableau_publish_datasource_filepath,_tableau_publish_token,_tableau_publish_server"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="6"
#!   NAME="Input"
#!   POSITION="-2296.77 2828.4"
#!   BOUNDING_RECT="-2296.77 2828.4 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="7"
#!   NAME="Output"
#!   POSITION="560.253 2828.4"
#!   BOUNDING_RECT="560.253 2828.4 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="8"
#!   NAME="Rejected"
#!   POSITION="560.253 2622.15"
#!   BOUNDING_RECT="560.253 2622.15 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="9"
#!   SOURCE_NODE="6"
#!   TARGET_NODE="2"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="10"
#!   SOURCE_NODE="1"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="11"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="1"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="7"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="12"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="14"
#!   SOURCE_NODE="5"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="5"
#!   SOURCE_PORT_DESC="fo 1 FAILED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
DEFAULT_MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_SERVER https://tableau.discomap.eea.europa.eu
DEFAULT_MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_TOKEN 
DEFAULT_MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_SITE_ID 
DEFAULT_MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_PROJECT_ID 
DEFAULT_MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_DATASOURCE_NAME 
DEFAULT_MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_DATASOURCE_FILEPATH 
#! START_HEADER
#! END_HEADER

LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO TableauPublishDatasource_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(TableauPublishDatasource_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(TableauPublishDatasource_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(TableauPublishDatasource_WORKSPACE_NAME)_Input1478527549 Input Splitter"   INPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

FACTORY_DEF * AttrSetFactory    FACTORY_NAME $(TableauPublishDatasource_WORKSPACE_NAME)_AttributeCreator    INPUT  FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Input"    MULTI_FEATURE_MODE NO 	 NULL_ATTR_MODE NO_OP 	 ATTRSET_CREATE_DIRECTIVES _PROPAGATE_MISSING_FDIV 	 ATTR_ACTION "" "_tableau_publish_server" "SET_TO" "$($(TableauPublishDatasource_WORKSPACE_NAME)_SERVER$encode)"     ATTR_ACTION "" "_tableau_publish_token" "SET_TO" "$($(TableauPublishDatasource_WORKSPACE_NAME)_TOKEN)"     ATTR_ACTION "" "_tableau_publish_site_id" "SET_TO" "$($(TableauPublishDatasource_WORKSPACE_NAME)_SITE_ID)"     ATTR_ACTION "" "_tableau_publish_project_id" "SET_TO" "$($(TableauPublishDatasource_WORKSPACE_NAME)_PROJECT_ID)"     ATTR_ACTION "" "_tableau_publish_datasource_name" "SET_TO" "$($(TableauPublishDatasource_WORKSPACE_NAME)_DATASOURCE_NAME)"     ATTR_ACTION "" "_tableau_publish_datasource_filepath" "SET_TO" "$($(TableauPublishDatasource_WORKSPACE_NAME)_DATASOURCE_FILEPATH$encode)"     ATTR_ACTION "" "_datasource_id" "SET_TO" ""    OUTPUT OUTPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_AttributeCreator_OUTPUT"


# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(TableauPublishDatasource_WORKSPACE_NAME)_PythonCaller    INPUT  FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_AttributeCreator_OUTPUT"    SYMBOL_NAME TableauPublisher    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE #<space>Contains<space>methods<space>used<space>to<space>build<space>and<space>parse<space>XML<lf>import<space>xml.etree.ElementTree<space>as<space>ET<lf>import<space>requests<space><space>#<space>Contains<space>methods<space>used<space>to<space>make<space>HTTP<space>requests<lf>import<space>sys<lf><lf>import<space>os.path<lf><lf>#<space>The<space>following<space>packages<space>are<space>used<space>to<space>build<space>a<space>multi-part<solidus>mixed<space>request.<lf>#<space>They<space>are<space>contained<space>in<space>the<space><apos>requests<apos><space>library.<lf>from<space>requests.packages.urllib3.fields<space>import<space>RequestField<lf>from<space>requests.packages.urllib3.filepost<space>import<space>encode_multipart_formdata<lf><lf>#<space>The<space>namespace<space>for<space>the<space>REST<space>API<space>is<space><apos>http:<solidus><solidus>tableausoftware.com<solidus>api<apos><space>for<space>Tableau<space>Server<space>9.0<space>or<space><apos>http:<solidus><solidus>tableau.com<solidus>api<apos><space>for<space>Tableau<space>Server<space>9.1<space>or<space>later<space><lf>TABLEAU_NS_MAP<space>=<space><opencurly><apos>t<apos>:<space><apos>http:<solidus><solidus>tableau.com<solidus>api<apos><closecurly><lf><lf>MAX_SINGLE_UPLOAD_SIZE<space>=<space>64<space>*<space>1024<space>*<space>1024<lf>CHUNK_UPLOAD_SIZE<space>=<space>64<space>*<space>1024<space>*<space>1024<lf><lf>####<lf>#<space>Functions<space>for<space>constructing<space>HTTP<space>multi-part<space>requests<space>and<space>dealing<space>with<space>errors<lf>####<lf><lf>def<space>_make_multipart<openparen>parts<closeparen>:<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>Creates<space>one<space><quote>chunk<quote><space>for<space>a<space>multi-part<space>upload.<lf><lf><space><space><space><space><apos>parts<apos><space>is<space>a<space>dictionary<space>that<space>provides<space>key-value<space>pairs<space>of<space>the<space>format<space>name:<space><openparen>filename<comma><space>body<comma><space>content_type<closeparen>.<lf><lf><space><space><space><space>Returns<space>the<space>post<space>body<space>and<space>the<space>content<space>type<space>string.<lf><lf><space><space><space><space>For<space>more<space>information<comma><space>see<space>this<space>post:<lf><space><space><space><space><space><space><space><space>http:<solidus><solidus>stackoverflow.com<solidus>questions<solidus>26299889<solidus>how-to-post-multipart-list-of-json-xml-files-using-python-requests<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>mime_multipart_parts<space>=<space><openbracket><closebracket><lf><lf><space><space><space><space>for<space>name<comma><space><openparen>filename<comma><space>blob<comma><space>content_type<closeparen><space>in<space>parts.items<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>multipart_part<space>=<space>RequestField<openparen>name=name<comma><space>data=blob<comma><space>filename=filename<closeparen><lf><space><space><space><space><space><space><space><space>multipart_part.make_multipart<openparen>content_type=content_type<closeparen><lf><space><space><space><space><space><space><space><space>mime_multipart_parts.append<openparen>multipart_part<closeparen><lf><lf><space><space><space><space>post_body<comma><space>content_type<space>=<space>encode_multipart_formdata<openparen>mime_multipart_parts<closeparen><lf><space><space><space><space>content_type<space>=<space><apos><apos>.join<openparen><openparen><apos>multipart<solidus>mixed<apos><comma><closeparen><space>+<space>content_type.partition<openparen><apos><semicolon><apos><closeparen><openbracket>1:<closebracket><closeparen><lf><space><space><space><space>return<space>post_body<comma><space>content_type<lf><lf>class<space>TableauServer<openparen>object<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>server<comma><space>site_name<comma><space>site_id=None<comma><space>signout_on_exit=True<comma><space>token=None<comma><space>user_id=None<comma><space>fout=sys.stdout<comma><space>ferr=sys.stderr<closeparen>:<lf><space><space><space><space><space><space><space><space>self.server<space>=<space>server.strip<openparen><apos><solidus><apos><closeparen><lf><space><space><space><space><space><space><space><space>self.site<space>=<space>site_name<lf><space><space><space><space><space><space><space><space>self.signout_on_exit<space>=<space>signout_on_exit<lf><space><space><space><space><space><space><space><space>self.site_id<space>=<space>site_id<lf><space><space><space><space><space><space><space><space>self.token<space>=<space>token<lf><space><space><space><space><space><space><space><space>self.user_id<space>=<space>user_id<lf><space><space><space><space><space><space><space><space>self._debug<space>=<space>True<lf><space><space><space><space><space><space><space><space>self._fout<space>=<space>fout<lf><space><space><space><space><space><space><space><space>self._ferr<space>=<space>ferr<lf><space><space><space><space><space><space><space><space>self.__debug<openparen><apos>Initialized<space>TableauServer<space>API<space>object<apos><closeparen><lf><space><space><space><space>def<space>__enter__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>self<lf><space><space><space><space>def<space>__exit__<openparen>self<comma><space>t<comma><space>value<comma><space>traceback<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>self.token<space>and<space>self.signout_on_exit:<space>return<space>self.signout<openparen><closeparen><space>==<space>200<lf><space><space><space><space><space><space><space><space>return<space>isinstance<openparen>value<comma><space>TypeError<closeparen><lf><space><space><space><space>def<space>__debug<openparen>self<comma>msg<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self._debug<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self._fout.write<openparen><apos>DEBUG:<space><opencurly><closecurly><backslash>n<apos>.format<openparen>msg<closeparen><closeparen><lf><space><space><space><space>def<space>sign_in<openparen>self<comma><space>username<comma><space>password<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>self.token:<space>self.signout<openparen><closeparen><lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>auth<solidus>signin<apos>.format<openparen>self.server<closeparen><lf><space><space><space><space><space><space><space><space>self.__debug<openparen>url<closeparen><lf><space><space><space><space><space><space><space><space>#<space>Builds<space>the<space>request<lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.Element<openparen><apos>tsRequest<apos><closeparen><lf><space><space><space><space><space><space><space><space>credentials_element<space>=<space>ET.SubElement<openparen>xml_payload_for_request<comma><space><apos>credentials<apos><comma><space>name=username<comma><space>password=password<closeparen><lf><space><space><space><space><space><space><space><space>ET.SubElement<openparen>credentials_element<comma><space><apos>site<apos><comma><space>contentUrl=self.site<closeparen><lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.tostring<openparen>xml_payload_for_request<closeparen><lf><space><space><space><space><space><space><space><space>#xml_payload_for_request<space>=<space><apos><lt>tsRequest<gt><lt>credentials<space>name=<quote><opencurly><closecurly><quote><space>password=<quote><opencurly><closecurly><quote><gt><lt>site<space>contentUrl=<quote><opencurly><closecurly><quote><solidus><gt><lt><solidus>credentials<gt><lt><solidus>tsRequest<gt><apos>.format<openparen>username<comma><space>password<comma><space>self.site_id<closeparen><lf><space><space><space><space><space><space><space><space>self.__debug<openparen>xml_payload_for_request<closeparen><lf><space><space><space><space><space><space><space><space>#<space>Makes<space>the<space>request<space>to<space>Tableau<space>Server<lf><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.post<openparen>url<comma><space>data=xml_payload_for_request<closeparen><lf><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>200:<lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>#<space>Reads<space>and<space>parses<space>the<space>response<lf><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Gets<space>the<space>token<space>and<space>site<space>ID<lf><space><space><space><space><space><space><space><space>self.token<space>=<space>xml_response.find<openparen><apos>t:credentials<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.attrib.get<openparen><apos>token<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.site_id<space>=<space>xml_response.find<openparen><apos>.<solidus><solidus>t:site<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.attrib.get<openparen><apos>id<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.user_id<space>=<space>xml_response.find<openparen><apos>.<solidus><solidus>t:user<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.attrib.get<openparen><apos>id<apos><closeparen><lf><space><space><space><space><space><space><space><space>return<space>self<lf><space><space><space><space>def<space>signout<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>self.__debug<openparen><apos>signout<comma><space>token=<opencurly><closecurly><apos>.format<openparen>self.token<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>if<space>not<space>self.token:<space>return<space>0<lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>auth<solidus>signout<apos>.format<openparen>self.server<closeparen><lf><space><space><space><space><space><space><space><space>r<space>=<space>requests.post<openparen>url<comma><space>headers=<opencurly><apos>x-tableau-auth<apos>:<space>self.token<closecurly><closeparen><lf><space><space><space><space><space><space><space><space>self.token<space>=<space>None<lf><space><space><space><space><space><space><space><space>return<space>r.status_code<lf><space><space><space><space>def<space>start_upload_session<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>Creates<space>a<space>POST<space>request<space>that<space>initiates<space>a<space>file<space>upload<space>session.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>Returns<space>a<space>session<space>ID<space>that<space>is<space>used<space>by<space>subsequent<space>functions<space>to<space>identify<space>the<space>upload<space>session.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>fileUploads<apos>.format<openparen>self.server<comma><space>self.site_id<closeparen><lf><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.post<openparen>url<comma><space>headers=<opencurly><quote>x-tableau-auth<quote>:<space>self.token<closecurly><closeparen><lf><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>201:<lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>return<space>xml_response.find<openparen><apos>t:fileUpload<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.attrib.get<openparen><apos>uploadSessionId<apos><closeparen><lf><lf><space><space><space><space>def<space>__publish_chunked<openparen>self<comma><space>filepath<comma><space>workbook_name<comma><space>project_id<comma><space>chunk_size<space>=<space>CHUNK_UPLOAD_SIZE<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>Publishes<space>a<space>file<space>to<space>Tableau<space>Server<space>in<space>chunks.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space><apos>filepath<apos><space><space><space><space><space><space><space><space><space>is<space>the<space>name<space>of<space>the<space>file<space>to<space>publish.<lf><space><space><space><space><space><space><space><space><apos>workbook_name<apos><space><space><space><space><space><space><space>is<space>the<space>workbook<space>name<space>as<space>a<space>string.<lf><space><space><space><space><space><space><space><space><apos>project_id<apos><space>is<space>the<space>ID<space><openparen>as<space>a<space>string<closeparen><space>of<space>the<space>project<space>to<space>publish<space>to.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>Returns<space>the<space>ID<space>of<space>the<space>published<space>workbbok.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>#<space>Initiates<space>an<space>upload<space>session<lf><space><space><space><space><space><space><space><space>uploadID<space>=<space>self.start_upload_session<openparen><closeparen><lf><space><space><space><space><space><space><space><space>#<space>Reads<space>the<space>source<space>file<space>in<space>chunks<space><openparen>default<space>is<space>100KB<closeparen><lf><lf><space><space><space><space><space><space><space><space>with<space>open<openparen>filepath<comma><space><apos>rb<apos><closeparen><space>as<space>fin:<lf><space><space><space><space><space><space><space><space><space><space><space><space>def<space>read_chunk<openparen><closeparen>:<space>return<space>fin.read<openparen>chunk_size<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>fileUploads<solidus><opencurly><closecurly><apos>.format<openparen>self.server<comma><space>self.site_id<comma><space>uploadID<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>for<space>data<space>in<space>iter<openparen>read_chunk<comma><space><apos><apos><closeparen>:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>payload<comma><space>content_type<space>=<space>_make_multipart<openparen><opencurly><apos>request_payload<apos>:<space><openparen><apos><apos><comma><space>b<apos><apos><comma><space><apos>text<solidus>xml<apos><closeparen><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tableau_file<apos>:<space><openparen><apos>file<apos><comma><space>data<comma><space><apos>application<solidus>octet-stream<apos><closeparen><closecurly><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<space>=<space>requests.put<openparen>url<comma><space>data=payload<comma><space>headers=<opencurly><quote>x-tableau-auth<quote>:<space>self.token<comma><space><quote>content-type<quote>:<space>content_type<closecurly><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.__debug<openparen><apos>Uploaded<space><opencurly><closecurly><space>bytes<comma><space>status<space><opencurly><closecurly><apos>.format<openparen>len<openparen>data<closeparen><comma><space>r.status_code<closeparen><closeparen><space><space><space><space><space><space><space><space><space><lf><lf><space><space><space><space><space><space><space><space>#<space>basename<space>is<space>not<space>used<space>when<space>uploading<space>in<space>chunks<lf><space><space><space><space><space><space><space><space>#<space>basename<space>=<space>os.path.basename<openparen>filepath<closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>file_ext<space>=<space>os.path.splitext<openparen>filepath<closeparen><openbracket>1<closebracket>.strip<openparen><apos>.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Builds<space>a<space>request<space>for<space>publishing<lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.Element<openparen><apos>tsRequest<apos><closeparen><lf><space><space><space><space><space><space><space><space>workbook_element<space>=<space>ET.SubElement<openparen>xml_payload_for_request<comma><space><apos>workbook<apos><comma><space>name=workbook_name<closeparen><lf><space><space><space><space><space><space><space><space>ET.SubElement<openparen>workbook_element<comma><space><apos>project<apos><comma><space>id=project_id<closeparen><lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.tostring<openparen>xml_payload_for_request<closeparen><lf><space><space><space><space><space><space><space><space>payload<comma><space>content_type<space>=<space>_make_multipart<openparen><opencurly><apos>request_payload<apos>:<space><openparen><apos><apos><comma><space>xml_payload_for_request<comma><space><apos>text<solidus>xml<apos><closeparen><closecurly><closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>workbooks?uploadSessionId=<opencurly><closecurly><amp>workbookType=<opencurly><closecurly><amp>overwrite=true<apos>.format<openparen>self.server<comma><space>self.site_id<comma><space>uploadID<comma><space>file_ext<closeparen><lf><space><space><space><space><space><space><space><space>self.__debug<openparen>url<closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.post<openparen>url<comma><space>data=payload<comma><space>headers=<opencurly><apos>x-tableau-auth<apos>:<space>self.token<comma><space><apos>content-type<apos>:<space>content_type<closecurly><closeparen><lf><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>201:<lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>return<space>xml_response.find<openparen><apos>t:workbook<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.get<openparen><apos>id<apos><closeparen><lf><lf><space><space><space><space>def<space>__publish_ds_chunked<openparen>self<comma><space>filepath<comma><space>datasource_name<comma><space>project_id<comma><space>chunk_size<space>=<space>CHUNK_UPLOAD_SIZE<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>Publishes<space>a<space>file<space>to<space>Tableau<space>Server<space>in<space>chunks.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space><apos>filepath<apos><space><space><space><space><space><space><space><space><space>is<space>the<space>name<space>of<space>the<space>file<space>to<space>publish.<lf><space><space><space><space><space><space><space><space><apos>datasource_name<apos><space><space>is<space>the<space>data<space>source<space>as<space>a<space>string.<lf><space><space><space><space><space><space><space><space><apos>project_id<apos><space>is<space>the<space>ID<space><openparen>as<space>a<space>string<closeparen><space>of<space>the<space>project<space>to<space>publish<space>to.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>Returns<space>the<space>ID<space>of<space>the<space>published<space>data<space>source.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>#<space>Initiates<space>an<space>upload<space>session<lf><space><space><space><space><space><space><space><space>uploadID<space>=<space>self.start_upload_session<openparen><closeparen><lf><space><space><space><space><space><space><space><space>#<space>Reads<space>the<space>source<space>file<space>in<space>chunks<space><openparen>default<space>is<space>100KB<closeparen><lf><lf><space><space><space><space><space><space><space><space>with<space>open<openparen>filepath<comma><space><apos>rb<apos><closeparen><space>as<space>fin:<lf><space><space><space><space><space><space><space><space><space><space><space><space>def<space>read_chunk<openparen><closeparen>:<space>return<space>fin.read<openparen>chunk_size<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>fileUploads<solidus><opencurly><closecurly><apos>.format<openparen>self.server<comma><space>self.site_id<comma><space>uploadID<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>for<space>data<space>in<space>iter<openparen>read_chunk<comma><space><apos><apos><closeparen>:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>payload<comma><space>content_type<space>=<space>_make_multipart<openparen><opencurly><apos>request_payload<apos>:<space><openparen><apos><apos><comma><space>b<apos><apos><comma><space><apos>text<solidus>xml<apos><closeparen><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tableau_file<apos>:<space><openparen><apos>file<apos><comma><space>data<comma><space><apos>application<solidus>octet-stream<apos><closeparen><closecurly><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<space>=<space>requests.put<openparen>url<comma><space>data=payload<comma><space>headers=<opencurly><quote>x-tableau-auth<quote>:<space>self.token<comma><space><quote>content-type<quote>:<space>content_type<closecurly><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.__debug<openparen><apos>Uploaded<space><opencurly><closecurly><space>bytes<comma><space>status<space><opencurly><closecurly><apos>.format<openparen>len<openparen>data<closeparen><comma><space>r.status_code<closeparen><closeparen><space><space><space><space><space><space><space><space><space><lf><lf><space><space><space><space><space><space><space><space>#<space>basename<space>is<space>not<space>used<space>when<space>uploading<space>in<space>chunks<lf><space><space><space><space><space><space><space><space>#<space>basename<space>=<space>os.path.basename<openparen>filepath<closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>file_ext<space>=<space>os.path.splitext<openparen>filepath<closeparen><openbracket>1<closebracket>.strip<openparen><apos>.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Builds<space>a<space>request<space>for<space>publishing<lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.Element<openparen><apos>tsRequest<apos><closeparen><lf><space><space><space><space><space><space><space><space>datasource_element<space>=<space>ET.SubElement<openparen>xml_payload_for_request<comma><space><apos>datasource<apos><comma><space>name=datasource_name<closeparen><lf><space><space><space><space><space><space><space><space>ET.SubElement<openparen>datasource_element<comma><space><apos>project<apos><comma><space>id=project_id<closeparen><lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.tostring<openparen>xml_payload_for_request<closeparen><lf><space><space><space><space><space><space><space><space>payload<comma><space>content_type<space>=<space>_make_multipart<openparen><opencurly><apos>request_payload<apos>:<space><openparen><apos><apos><comma><space>xml_payload_for_request<comma><space><apos>text<solidus>xml<apos><closeparen><closecurly><closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>datasources?uploadSessionId=<opencurly><closecurly><amp>datasourceType=<opencurly><closecurly><amp>overwrite=true<apos>.format<openparen>self.server<comma><space>self.site_id<comma><space>uploadID<comma><space>file_ext<closeparen><lf><space><space><space><space><space><space><space><space>self.__debug<openparen>url<closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.post<openparen>url<comma><space>data=payload<comma><space>headers=<opencurly><apos>x-tableau-auth<apos>:<space>self.token<comma><space><apos>content-type<apos>:<space>content_type<closecurly><closeparen><lf><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>201:<lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>return<space>xml_response.find<openparen><apos>t:datasource<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.get<openparen><apos>id<apos><closeparen><lf><space><space><space><space>def<space>publish_datasource<openparen>self<comma><space>filepath<comma><space>datasource_name<comma><space>project_id<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>Publishes<space>a<space>file<space>to<space>Tableau<space>Server<space>in<space>a<space>single<space>request.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space><apos>filepath<apos><space><space><space><space><space><space><space><space><space>is<space>the<space>path<space>of<space>the<space>file<space>to<space>publish.<lf><space><space><space><space><space><space><space><space><apos>datasource_name<apos><space><space>is<space>the<space>data<space>source<space>name<space>as<space>a<space>string.<lf><space><space><space><space><space><space><space><space><apos>project_id<apos><space>is<space>the<space>ID<space><openparen>as<space>a<space>string<closeparen><space>of<space>the<space>project<space>to<space>publish<space>to.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>Returns<space>the<space>ID<space>of<space>the<space>published<space>data<space>source.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>with<space>open<openparen>filepath<comma><space><apos>rb<apos><closeparen><space>as<space>f:<lf><space><space><space><space><space><space><space><space><space><space><space><space>old_file_position<space>=<space>f.tell<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>f.seek<openparen>0<comma><space>os.SEEK_END<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>size<space>=<space>f.tell<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>size<space><gt><space>MAX_SINGLE_UPLOAD_SIZE:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>f.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>return<space>self.__publish_ds_chunked<openparen>filepath<comma><space>datasource_name<comma><space>project_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>f.seek<openparen>old_file_position<comma><space>os.SEEK_SET<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>datasource_bytes<space>=<space>f.read<openparen><closeparen><lf><space><space><space><space><space><space><space><space>basename<space>=<space>os.path.basename<openparen>filepath<closeparen><lf><space><space><space><space><space><space><space><space>file_ext<space>=<space>os.path.splitext<openparen>filepath<closeparen><openbracket>1<closebracket>.strip<openparen><apos>.<apos><closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Builds<space>the<space>publish<space>request<lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.Element<openparen><apos>tsRequest<apos><closeparen><lf><space><space><space><space><space><space><space><space>datasource_element<space>=<space>ET.SubElement<openparen>xml_payload_for_request<comma><space><apos>datasource<space><apos><comma><space>name=datasource_name<closeparen><lf><space><space><space><space><space><space><space><space>ET.SubElement<openparen>datasource_element<comma><space><apos>project<apos><comma><space>id=project_id<closeparen><lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.tostring<openparen>xml_payload_for_request<closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>payload<comma><space>content_type<space>=<space>_make_multipart<openparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><opencurly><apos>request_payload<apos>:<space><openparen><apos><apos><comma><space>xml_payload_for_request<comma><space><apos>text<solidus>xml<apos><closeparen><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tableau_datasource<apos>:<space><openparen>basename<comma><space>datasource_bytes<comma><space><apos>application<solidus>octet-stream<apos><closeparen><closecurly><closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>datasources?overwrite=true<apos>.format<openparen>self.server<comma><space>self.site_id<closeparen><lf><space><space><space><space><space><space><space><space>self.__debug<openparen>url<closeparen><lf><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.post<openparen>url<comma><space>data=payload<comma><space>headers=<opencurly><apos>x-tableau-auth<apos>:<space>self.token<comma><space><apos>content-type<apos>:<space>content_type<closecurly><closeparen><lf><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>201:<lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>return<space>xml_response.find<openparen><apos>t:datasource<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.get<openparen><apos>id<apos><closeparen><lf><space><space><space><space>def<space>publish_workbook<openparen>self<comma><space>filepath<comma><space>workbook_name<comma><space>project_id<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>Publishes<space>a<space>file<space>to<space>Tableau<space>Server<space>in<space>a<space>single<space>request.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space><apos>filepath<apos><space><space><space><space><space><space><space><space><space>is<space>the<space>path<space>of<space>the<space>file<space>to<space>publish.<lf><space><space><space><space><space><space><space><space><apos>workbook_name<apos><space><space><space><space>is<space>the<space>workbook<space>name<space>as<space>a<space>string.<lf><space><space><space><space><space><space><space><space><apos>project_id<apos><space>is<space>the<space>ID<space><openparen>as<space>a<space>string<closeparen><space>of<space>the<space>project<space>to<space>publish<space>to.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>Returns<space>the<space>ID<space>of<space>the<space>published<space>workbook.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>with<space>open<openparen>filepath<comma><space><apos>rb<apos><closeparen><space>as<space>f:<lf><space><space><space><space><space><space><space><space><space><space><space><space>old_file_position<space>=<space>f.tell<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>f.seek<openparen>0<comma><space>os.SEEK_END<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>size<space>=<space>f.tell<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>size<space><gt><space>MAX_SINGLE_UPLOAD_SIZE:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>f.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>return<space>self.__publish_chunked<openparen>filepath<comma><space>workbook_name<comma><space>project_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>f.seek<openparen>old_file_position<comma><space>os.SEEK_SET<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>workbook_bytes<space>=<space>f.read<openparen><closeparen><lf><space><space><space><space><space><space><space><space>basename<space>=<space>os.path.basename<openparen>filepath<closeparen><lf><space><space><space><space><space><space><space><space>file_ext<space>=<space>os.path.splitext<openparen>filepath<closeparen><openbracket>1<closebracket>.strip<openparen><apos>.<apos><closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Builds<space>the<space>publish<space>request<lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.Element<openparen><apos>tsRequest<apos><closeparen><lf><space><space><space><space><space><space><space><space>workbook_element<space>=<space>ET.SubElement<openparen>xml_payload_for_request<comma><space><apos>workbook<apos><comma><space>name=workbook_name<closeparen><lf><space><space><space><space><space><space><space><space>ET.SubElement<openparen>workbook_element<comma><space><apos>project<apos><comma><space>id=project_id<closeparen><lf><space><space><space><space><space><space><space><space>xml_payload_for_request<space>=<space>ET.tostring<openparen>xml_payload_for_request<closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>payload<comma><space>content_type<space>=<space>_make_multipart<openparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><opencurly><apos>request_payload<apos>:<space><openparen><apos><apos><comma><space>xml_payload_for_request<comma><space><apos>text<solidus>xml<apos><closeparen><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tableau_workbook<apos>:<space><openparen>basename<comma><space>workbook_bytes<comma><space><apos>application<solidus>octet-stream<apos><closeparen><closecurly><closeparen><lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>workbooks?workbookType=<opencurly><closecurly><amp>overwrite=true<apos>.format<openparen>self.server<comma><space>self.site_id<comma><space>file_ext<closeparen><lf><space><space><space><space><space><space><space><space>self.__debug<openparen>url<closeparen><lf><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.post<openparen>url<comma><space>data=payload<comma><space>headers=<opencurly><apos>x-tableau-auth<apos>:<space>self.token<comma><space><apos>content-type<apos>:<space>content_type<closecurly><closeparen><lf><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>201:<lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space>return<space>xml_response.find<openparen><apos>t:workbook<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.get<openparen><apos>id<apos><closeparen><lf><lf><space><space><space><space>def<space>query_projects<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>Yields<space>tuples<space>of<space><openparen>project_name<comma><space>project_id<closeparen><space>on<space>the<space>site.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>The<space>function<space>paginates<space>over<space>results<space><openparen>if<space>required<closeparen><space>using<space>a<space>page<space>size<space>of<space>100.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>not<space>self.token:<space>raise<space>Exception<openparen><apos>Not<space>signed<space>in<apos><closeparen><lf><space><space><space><space><space><space><space><space>page_num<comma><space>page_size<space>=<space>1<comma><space>100<lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>projects<apos>.format<openparen>self.server<comma><space>self.site_id<closeparen><lf><space><space><space><space><space><space><space><space>count<space>=<space>0<lf><space><space><space><space><space><space><space><space>while<space>True<space>and<space>count<space><lt><space>1000:<lf><space><space><space><space><space><space><space><space><space><space><space><space>paged_url<space>=<space><apos><opencurly><closecurly>?pageSize=<opencurly><closecurly><amp>pageNumber=<opencurly><closecurly><apos>.format<openparen>url<comma><space>page_size<comma><space>page_num<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.__debug<openparen>paged_url<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.get<openparen>paged_url<comma><space>headers=<opencurly><quote>x-tableau-auth<quote>:<space>self.token<closecurly><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>server_response.encoding<space>=<space><quote>utf-8<quote><semicolon><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>200:<space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>total_count_of_projects<space>=<space>int<openparen>xml_response.find<openparen><apos>t:pagination<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.attrib.get<openparen><apos>totalAvailable<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>for<space>project<space>in<space>xml_response.findall<openparen><apos>.<solidus><solidus>t:project<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>count<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>yield<space>project.get<openparen><apos>name<apos><closeparen><comma><space>project.get<openparen><apos>id<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>count<space><gt>=<space>total_count_of_projects:<space>break<lf><space><space><space><space><space><space><space><space><space><space><space><space>page_num<space>+=<space>1<lf><space><space><space><space>def<space>list_workbooks<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>Returns<space>a<space>list<space>of<space>workbooks<space>that<space>the<space>current<space>user<space>has<space>permission<space>to<space>read<space><openparen>a<space>list<space>of<space><lt>workbook<gt><space>elements<closeparen>.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space><apos>user_id<apos><space>is<space>the<space>LUID<space><openparen>as<space>a<space>string<closeparen><space>of<space>the<space>user<space>to<space>get<space>workbooks<space>for.<lf><space><space><space><space><lf><space><space><space><space><space><space><space><space>The<space>function<space>paginates<space>over<space>the<space>results<space><openparen>if<space>required<closeparen><space>using<space>a<space>page<space>size<space>of<space>100.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>page_num<comma><space>page_size<space>=<space>1<comma><space>100<lf><space><space><space><space><space><space><space><space>url<space>=<space><apos><opencurly><closecurly><solidus>api<solidus>2.2<solidus>sites<solidus><opencurly><closecurly><solidus>users<solidus><opencurly><closecurly><solidus>workbooks<apos>.format<openparen>self.server<comma><space>self.site_id<comma><space>self.user_id<closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>count<space>=<space>0<lf><space><space><space><space><space><space><space><space>while<space>True<space>and<space>count<space><lt><space>1000:<lf><space><space><space><space><space><space><space><space><space><space><space><space>paged_url<space>=<space><apos><opencurly><closecurly>?pageSize=<opencurly><closecurly><amp>pageNumber=<opencurly><closecurly><apos>.format<openparen>url<comma><space>page_size<comma><space>page_num<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>server_response<space>=<space>requests.get<openparen>paged_url<comma><space>headers=<opencurly><quote>x-tableau-auth<quote>:<space>self.token<closecurly><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>server_response.status_code<space>!=<space>200:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>Exception<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.__debug<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>xml_response<space>=<space>ET.fromstring<openparen>server_response.text<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>total_count_of_workbooks<space>=<space>int<openparen>xml_response.find<openparen><apos>t:pagination<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>.attrib.get<openparen><apos>totalAvailable<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>for<space>workbook<space>in<space>xml_response.findall<openparen><apos>.<solidus><solidus>t:workbook<apos><comma><space>namespaces=TABLEAU_NS_MAP<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>count<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>yield<space>map<openparen>workbook.get<comma><space><openparen><apos>id<apos><comma><apos>name<apos><comma><apos>contentUrl<apos><comma><apos>showTabs<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>count<space><gt>=<space>total_count_of_workbooks:<space>break<lf><space><space><space><space><space><space><space><space><space><space><space><space>page_num<space>+=<space>1<lf>import<space>fmeobjects<lf><lf>class<space>LogWrapper<openparen>object<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>fmelog<comma><space>fmt=<apos><opencurly><closecurly><apos><comma><space>level=fmeobjects.FME_INFORM<closeparen>:<lf><space><space><space><space><space><space><space><space>self.fmelog<space>=<space>fmelog<lf><space><space><space><space><space><space><space><space>self.fmt<space>=<space>fmt<lf><space><space><space><space><space><space><space><space>self.level<space>=<space>level<lf><space><space><space><space>def<space>write<openparen>self<comma>str<closeparen>:<lf><space><space><space><space><space><space><space><space>self.fmelog.logMessageString<openparen>self.fmt.format<openparen>str.strip<openparen><apos><backslash>n<apos><closeparen><closeparen><comma><space>self.level<closeparen><lf><lf>class<space>TableauPublisher<openparen>object<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>self.logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.logwrapinfo<space>=<space>LogWrapper<openparen>self.logger<comma><space>fmt=<apos>TableauPublisher:<space><opencurly><closecurly><apos><closeparen><lf><space><space><space><space><space><space><space><space>self.logwraperror<space>=<space>LogWrapper<openparen>self.logger<comma><space>fmt=<apos>TableauPublisher:<space><opencurly><closecurly><apos><comma><space>level=fmeobjects.FME_ERROR<closeparen><lf><space><space><space><space><space><space><space><space>self.logger.logMessageString<openparen><quote>TableauPublisher<space>initialized<quote><comma><space>fmeobjects.FME_INFORM<closeparen><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>server_url<comma><space>token<comma><space>site_id<comma><space>project_id<comma><space>datasource_name<comma><space>datasource_filepath<space>=<space>map<openparen>feature.getAttribute<comma><space><openparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>_tableau_publish_server<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><comma><space><apos>_tableau_publish_token<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><comma><space><apos>_tableau_publish_site_id<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><comma><space><apos>_tableau_publish_project_id<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><comma><space><apos>_tableau_publish_datasource_name<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><comma><space><apos>_tableau_publish_datasource_filepath<apos><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>datasource_id_attr<space>=<space><apos>_datasource_id<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space>server<space>=<space>TableauServer<openparen>server_url<comma><space>None<comma><space>site_id=site_id<comma><space>token=token<comma><space>signout_on_exit=False<comma>fout=self.logwrapinfo<comma><space>ferr=self.logwraperror<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>datasource_id<space>=<space>server.publish_datasource<openparen>datasource_filepath<comma><space>datasource_name<comma><space>project_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>feature.setAttribute<openparen>datasource_id_attr<comma><space>datasource_id<closeparen><lf><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.logger.logException<openparen>e<comma><space>fmeobjects.FME_ERROR<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>_tableau_publish_error<apos><comma><space>str<openparen>e<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>self.logger.logMessageString<openparen><quote>TableauPublisher<space>closed<quote><comma><space>fmeobjects.FME_INFORM<closeparen><lf><space><space><space><space><space><space><space><space>del<openparen>self.logger<closeparen><space>#<space>Needed<space>to<space>avoid<space><quote>Not<space>All<space>FME<space>sessions<space>were<space>destroyed<quote>    OUTPUT PYOUTPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_PythonCaller_OUTPUT"

# -------------------------------------------------------------------------

FACTORY_DEF * TestFactory    FACTORY_NAME $(TableauPublishDatasource_WORKSPACE_NAME)_Tester    INPUT  FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_PythonCaller_OUTPUT"    TEST _tableau_publish_error ATTRIBUTE_IS_MISSING "" ENCODED    BOOLEAN_OPERATOR OR    OUTPUT PASSED FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Tester_PASSED"    OUTPUT FAILED FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Tester_FAILED"
# -------------------------------------------------------------------------

INCLUDE [    set macroLine "MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_2_LIST_EXP ";    foreach attr [split ""] {       set attr [FME_DecodeText $attr];       set attr [regsub "{}$" $attr "{}.*"];       set attr [regsub -all "{}" $attr "\\{\[0-9\]+\\}"];       append macroLine ",^$attr$";    };    puts $macroLine; ]
FACTORY_DEF * TeeFactory    FACTORY_NAME $(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_2    INPUT  FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Tester_FAILED"    OUTPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_2_OUTPUT"        @RemoveAttributes(fme_encoded,_tableau_publish_datasource_name,_datasource_id,_tableau_publish_project_id,_tableau_publish_site_id,_tableau_publish_datasource_filepath,_tableau_publish_token,_tableau_publish_server)        @RemoveAttributes(fme_pcre_match"$($(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_2_LIST_EXP)")

# -------------------------------------------------------------------------

INCLUDE [    set macroLine "MACRO $(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_LIST_EXP ";    foreach attr [split ""] {       set attr [FME_DecodeText $attr];       set attr [regsub "{}$" $attr "{}.*"];       set attr [regsub -all "{}" $attr "\\{\[0-9\]+\\}"];       append macroLine ",^$attr$";    };    puts $macroLine; ]
FACTORY_DEF * TeeFactory    FACTORY_NAME $(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover    INPUT  FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Tester_PASSED"    OUTPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_OUTPUT"        @RemoveAttributes(fme_encoded,_tableau_publish_datasource_name,_tableau_publish_error,_tableau_publish_project_id,_tableau_publish_site_id,_tableau_publish_datasource_filepath,_tableau_publish_token,_tableau_publish_server)        @RemoveAttributes(fme_pcre_match"$($(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_LIST_EXP)")

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(TableauPublishDatasource_WORKSPACE_NAME)_Output1478527549 Output Collector"   INPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_OUTPUT"   OUTPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Output"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(TableauPublishDatasource_WORKSPACE_NAME)_Rejected1478527549 Output Collector"   INPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_AttributeRemover_2_OUTPUT"   OUTPUT FEATURE_TYPE "$(TableauPublishDatasource_WORKSPACE_NAME)_Rejected"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(TableauPublishDatasource_WORKSPACE_NAME))}]
