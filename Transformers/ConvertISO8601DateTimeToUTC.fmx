#! <?xml version="1.0" encoding="windows-1252" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN ConvertISO8601DateTimeToUTC,1,,91d5b288-1459-4f72-b5d9-4d6fc0bebe62,"Linked by Default",No,NO_PARALLELISM,,No,14235,YES,No
# <p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Converts an ISO8601 datetime (yyyy-MM-dd'T'HH:mm:ss.SSSZ) to UTC</p>
# 
# TRANSFORMER_END
#! PASSWORD=""
#! ATTR_TYPE_ENCODING="SDF"
#! VIEW_POSITION="-618 15"
#! SHOW_INFO_NODES="true"
#! FME_LINKED_TRANSFORMER_VERSION="1"
#! FMX_INSERT_MODE="Linked by Default"
#! BLOCKED_LOOPING="No"
#! DESCRIPTION="&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Converts an ISO8601 datetime (yyyy-MM-dd&apos;T&apos;HH:mm:ss.SSSZ) to UTC&lt;/p&gt;&#10;"
#! TITLE="ConvertISO8601DateTimeToUTC"
#! MAX_LOOP_ITERATIONS=""
#! ITERATION_COUNT_ATTR=""
#! FME_BUILD_NUM="14235"
#! ZOOM_SCALE="100"
#! CATEGORY=""
#! LEGAL_TERMS_CONDITIONS="&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;"
#! FME_PROCESS_GROUP_BY=""
#! USAGE="&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;"
#! HISTORY=""
#! FME_DOCUMENT_PRIORGUID="89a518bc-7fa1-4fee-8b56-22489c377305"
#! DOC_TOP_LEFT="-547 -235"
#! XFORM_DEPRECATED="No"
#! REQUIREMENTS_KEYWORD="none"
#! LAST_SAVE_DATE="2015-01-20T12:37:29"
#! WORKSPACE_VERSION="1"
#! LAST_SAVE_BUILD="FME(R) 2014 (20140120 - Build 14235 - WIN64)"
#! FME_SERVER_SERVICES=""
#! REQUIREMENTS="&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;"
#! DOC_EXTENTS="2811 10"
#! FME_DOCUMENT_GUID="91d5b288-1459-4f72-b5d9-4d6fc0bebe62"
#! FME_PROCESS_COUNT="NO_PARALLELISM"
#! SHOW_ANNOTATIONS="true"
#! FME_PROCESS_GROUPS_ORDERED="No"
#! WARN_INVALID_XFORM_PARAM="Yes"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI OPTIONAL TEXT DATETIME_ATTRIBUTE the attribute to parse:"
#! DEFAULT_VALUE="_iso_datetime_object"
#! IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! <BOOKMARK
#! IDENTIFIER="13"
#! NAME="Parse ISO datetime with Python and convert to FME date"
#! DESCRIPTION="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;MS Shell Dlg 2&apos;; font-size:11px; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-size:11px;&quot;&gt;Using python, the timestamp is parsed and UTC offsets are applied. Then an FME object is created from the resulting string output.&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#! TOP_LEFT="496 -6"
#! BOTTOM_RIGHT="1632 -456"
#! STICKY="true"
#! COLOUR="0.00784314,0.964706,0.603922"
#! CONTENTS="12 1 17 "
#! />
#! <BOOKMARK
#! IDENTIFIER="15"
#! NAME="Dynamic attribute retrieval"
#! DESCRIPTION="&lt;html&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;"
#! TOP_LEFT="-89 -145"
#! BOTTOM_RIGHT="465 -381"
#! STICKY="true"
#! COLOUR="0.129412,0.854902,0.329412"
#! CONTENTS="6 "
#! />
#! <BOOKMARK
#! IDENTIFIER="16"
#! NAME="Remove dynamic attribute"
#! DESCRIPTION="&lt;html&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;"
#! TOP_LEFT="1667 -136"
#! BOTTOM_RIGHT="2221 -372"
#! STICKY="true"
#! COLOUR="0.909804,0.67451,0.494118"
#! CONTENTS="9 "
#! />
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#! IDENTIFIER="1"
#! TYPE="PythonCaller"
#! VERSION="4"
#! POSITION="570 -228"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_iso_datetime_object" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;re&lt;comma&gt;&lt;space&gt;datetime&lt;lf&gt;from&lt;space&gt;datetime&lt;space&gt;import&lt;space&gt;tzinfo&lt;comma&gt;&lt;space&gt;timedelta&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;#Timezone&lt;space&gt;class&lt;space&gt;representing&lt;space&gt;UTC&lt;solidus&gt;Z&lt;lf&gt;class&lt;space&gt;UTC&lt;openparen&gt;tzinfo&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;UTC&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;utcoffset&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;dt&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;datetime.timedelta&lt;openparen&gt;hours=0&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;tzname&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;dt&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;quote&gt;UTC&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;#Timezone&lt;space&gt;class&lt;space&gt;representing&lt;space&gt;offset&lt;space&gt;to&lt;space&gt;UTC&lt;lf&gt;class&lt;space&gt;ISO&lt;openparen&gt;tzinfo&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;ISO&lt;space&gt;timezone&lt;space&gt;offset&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;offset&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.offset&lt;space&gt;=&lt;space&gt;offset&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;utcoffset&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;dt&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;self.offset&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;tzname&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;dt&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;quote&gt;isoTimezone&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;parseISO8601Date&lt;openparen&gt;providedDate&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;sanity&lt;space&gt;checks&lt;space&gt;for&lt;space&gt;empty&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;providedDate&lt;space&gt;is&lt;space&gt;None:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;providedDate&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;len&lt;openparen&gt;providedDate&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;0:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;providedDate&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;s&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;providedDate&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;&lt;apos&gt;:&lt;apos&gt;&lt;space&gt;in&lt;space&gt;s&lt;space&gt;and&lt;space&gt;&lt;apos&gt;-&lt;apos&gt;&lt;space&gt;in&lt;space&gt;s:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;isUTC&lt;space&gt;=&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;s&lt;openbracket&gt;len&lt;openparen&gt;s&lt;closeparen&gt;-1&lt;closebracket&gt;&lt;space&gt;==&lt;space&gt;&lt;apos&gt;Z&lt;apos&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateProps&lt;space&gt;=&lt;space&gt;map&lt;openparen&gt;int&lt;comma&gt;&lt;space&gt;re.split&lt;openparen&gt;&lt;apos&gt;&lt;openbracket&gt;^&lt;backslash&gt;d&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;s&lt;openbracket&gt;:-1&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;isUTC&lt;space&gt;=&lt;space&gt;True&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;else:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateProps&lt;space&gt;=&lt;space&gt;map&lt;openparen&gt;int&lt;comma&gt;&lt;space&gt;re.split&lt;openparen&gt;&lt;apos&gt;&lt;openbracket&gt;^&lt;backslash&gt;d&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;s&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;len&lt;openparen&gt;dateProps&lt;closeparen&gt;&lt;space&gt;&lt;lt&gt;&lt;space&gt;6:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;we&lt;space&gt;have&lt;space&gt;less&lt;space&gt;than&lt;space&gt;6&lt;space&gt;parsed&lt;space&gt;int&lt;space&gt;-&lt;gt&gt;&lt;space&gt;does&lt;space&gt;not&lt;space&gt;make&lt;space&gt;an&lt;space&gt;iso&lt;space&gt;datetime&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;providedDate&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;has24HourFormat&lt;space&gt;=&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;dateProps&lt;openbracket&gt;3&lt;closebracket&gt;&lt;space&gt;==&lt;space&gt;24:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#later&lt;space&gt;add&lt;space&gt;one&lt;space&gt;day&lt;space&gt;as&lt;space&gt;offset&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateProps&lt;openbracket&gt;3&lt;closebracket&gt;&lt;space&gt;=&lt;space&gt;0&lt;semicolon&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;has24HourFormat&lt;space&gt;=&lt;space&gt;True&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;len&lt;openparen&gt;dateProps&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;6:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#no&lt;space&gt;time&lt;space&gt;zone&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateValue&lt;space&gt;=&lt;space&gt;datetime.datetime&lt;openparen&gt;*dateProps&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;len&lt;openparen&gt;dateProps&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;7:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#no&lt;space&gt;time&lt;space&gt;zone&lt;comma&gt;&lt;space&gt;but&lt;space&gt;milliseconds&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateValue&lt;space&gt;=&lt;space&gt;datetime.datetime&lt;openparen&gt;*dateProps&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;len&lt;openparen&gt;dateProps&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;8&lt;space&gt;or&lt;space&gt;len&lt;openparen&gt;dateProps&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;9:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#time&lt;space&gt;zone&lt;space&gt;with&lt;space&gt;or&lt;space&gt;without&lt;space&gt;millis&lt;space&gt;&lt;openparen&gt;the&lt;space&gt;last&lt;space&gt;two&lt;space&gt;int&lt;space&gt;represent&lt;space&gt;the&lt;space&gt;timezone&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateValue&lt;space&gt;=&lt;space&gt;datetime.datetime&lt;openparen&gt;*dateProps&lt;openbracket&gt;:-2&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#check&lt;space&gt;if&lt;space&gt;positive&lt;space&gt;or&lt;space&gt;negativ&lt;space&gt;offset&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sign&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;s&lt;openbracket&gt;len&lt;openparen&gt;s&lt;closeparen&gt;-6&lt;closebracket&gt;&lt;space&gt;==&lt;space&gt;&lt;apos&gt;-&lt;apos&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sign&lt;space&gt;=&lt;space&gt;-1&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#create&lt;space&gt;datetime&lt;space&gt;with&lt;space&gt;a&lt;space&gt;timezone&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateValue&lt;space&gt;=&lt;space&gt;dateValue.replace&lt;openparen&gt;tzinfo&lt;space&gt;=&lt;space&gt;ISO&lt;openparen&gt;datetime.timedelta&lt;openparen&gt;hours=sign*dateProps&lt;openbracket&gt;len&lt;openparen&gt;dateProps&lt;closeparen&gt;-2&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;minutes=sign*dateProps&lt;openbracket&gt;len&lt;openparen&gt;dateProps&lt;closeparen&gt;-1&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;else:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#nothing&lt;space&gt;worked&lt;comma&gt;&lt;space&gt;return&lt;space&gt;original&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;providedDate&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;has24HourFormat:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;add&lt;space&gt;the&lt;space&gt;day&lt;space&gt;&lt;openparen&gt;due&lt;space&gt;to&lt;space&gt;24:00:00&lt;space&gt;format&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateValue&lt;space&gt;=&lt;space&gt;dateValue&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=1&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#CONVERT&lt;space&gt;EVERYTHING&lt;space&gt;TO&lt;space&gt;UTC!&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;&lt;openparen&gt;dateValue.tzinfo&lt;space&gt;is&lt;space&gt;not&lt;space&gt;None&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dateValue&lt;space&gt;=&lt;space&gt;dateValue.replace&lt;openparen&gt;tzinfo&lt;space&gt;=&lt;space&gt;None&lt;closeparen&gt;&lt;space&gt;-&lt;space&gt;dateValue.tzinfo.utcoffset&lt;openparen&gt;dateValue&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#print&lt;space&gt;dateValue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;dateValue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;else:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#obviously&lt;space&gt;no&lt;space&gt;iso&lt;space&gt;datetime&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;providedDate&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;processFeature&lt;openparen&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;att&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;quote&gt;_iso_datetime_object&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dto&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;att&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;dto&lt;space&gt;is&lt;space&gt;not&lt;space&gt;None:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;dto&lt;space&gt;=&lt;space&gt;parseISO8601Date&lt;openparen&gt;dto&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;att&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;dto&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParseDateToUTC"/>
#! <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="processFeature"/>
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="6"
#! TYPE="AttributeCreator"
#! VERSION="4"
#! POSITION="-15 -235"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_iso_datetime_object" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="NUM_PRIOR_FEATURES" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="MULTI_FEATURE_MODE" PARM_VALUE="NO"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateTempAttribute"/>
#! <XFORM_PARM PARM_NAME="NULL_ATTR_MODE_DISPLAY" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="NUM_SUBSEQUENT_FEATURES" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="NULL_ATTR_VALUE" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="_iso_datetime_object,$(DATETIME_ATTRIBUTE)"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="9"
#! TYPE="AttributeRemover"
#! VERSION="0"
#! POSITION="1741 -226"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="REMOVE_ATTRS" PARM_VALUE="_iso_datetime_object"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="RemoveTempAttribute"/>
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="12"
#! TYPE="DateFormatter"
#! VERSION="4"
#! POSITION="1152 -230"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_iso_datetime_object" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="DATE_ATTR" PARM_VALUE="$(DATETIME_ATTRIBUTE)"/>
#! <XFORM_PARM PARM_NAME="FMT" PARM_VALUE="FME Date/Time (%Y%m%d%H%M%S)"/>
#! <XFORM_PARM PARM_NAME="SRCFMT" PARM_VALUE="Unknown - Automatic Detection"/>
#! <XFORM_PARM PARM_NAME="INVALID_DATE_VALUE" PARM_VALUE="_FME_NO_OP_"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="DateFormatter"/>
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#! IDENTIFIER="2"
#! NAME="FeatureIn"
#! POSITION="-547 -234"
#! COLLAPSED="false"
#! PUBLISHED="true"
#! IS_SOURCE="true"
#! ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#! IDENTIFIER="4"
#! NAME="FeatureOut"
#! POSITION="2264 -225"
#! COLLAPSED="false"
#! IS_SOURCE="false"
#! ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#! IDENTIFIER="7"
#! SOURCE_NODE="2"
#! TARGET_NODE="6"
#! SOURCE_PORT_DESC="0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="8"
#! SOURCE_NODE="6"
#! TARGET_NODE="1"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="11"
#! SOURCE_NODE="9"
#! TARGET_NODE="4"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="14"
#! SOURCE_NODE="12"
#! TARGET_NODE="9"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="17"
#! SOURCE_NODE="1"
#! TARGET_NODE="12"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
#! 
DEFAULT_MACRO $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DATETIME_ATTRIBUTE _iso_datetime_object
#! START_HEADER
#! END_HEADER

LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO ConvertISO8601DateTimeToUTC_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_FeatureIn1421753849 Input Splitter"   INPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_FeatureIn"   OUTPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_FeatureIn"
# -------------------------------------------------------------------------
FACTORY_DEF * AttrSetFactory FACTORY_NAME $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_CreateTempAttribute INPUT  FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_FeatureIn" ATTR _iso_datetime_object $($(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DATETIME_ATTRIBUTE$encode)    OUTPUT OUTPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_CreateTempAttribute_OUTPUT" 
# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_ParseDateToUTC    INPUT  FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_CreateTempAttribute_OUTPUT"    SYMBOL_NAME processFeature    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>re<comma><space>datetime<lf>from<space>datetime<space>import<space>tzinfo<comma><space>timedelta<lf>import<space>fmeobjects<lf><lf>#Timezone<space>class<space>representing<space>UTC<solidus>Z<lf>class<space>UTC<openparen>tzinfo<closeparen>:<lf><space><space><space><space><quote><quote><quote>UTC<quote><quote><quote><lf><lf><space><space><space><space>def<space>utcoffset<openparen>self<comma><space>dt<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>datetime.timedelta<openparen>hours=0<closeparen><lf><lf><space><space><space><space>def<space>tzname<openparen>self<comma><space>dt<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space><quote>UTC<quote><lf><lf>#Timezone<space>class<space>representing<space>offset<space>to<space>UTC<lf>class<space>ISO<openparen>tzinfo<closeparen>:<lf><space><space><space><space><quote><quote><quote>ISO<space>timezone<space>offset<quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen><closeparen><lf><lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>offset<closeparen>:<lf><space><space><space><space><space><space><space><space>self.offset<space>=<space>offset<lf><space><space><space><space><lf><space><space><space><space>def<space>utcoffset<openparen>self<comma><space>dt<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>self.offset<lf><lf><space><space><space><space>def<space>tzname<openparen>self<comma><space>dt<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space><quote>isoTimezone<quote><lf><lf>def<space>parseISO8601Date<openparen>providedDate<closeparen>:<lf><space><space><space><space>#<space>sanity<space>checks<space>for<space>empty<lf><space><space><space><space>if<space>providedDate<space>is<space>None:<lf><space><space><space><space><space><space><space><space>return<space>providedDate<lf><space><space><space><space>if<space>len<openparen>providedDate<closeparen><space>==<space>0:<lf><space><space><space><space><space><space><space><space>return<space>providedDate<lf><lf><space><space><space><space>s<space>=<space>str<openparen>providedDate<closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space>if<space><apos>:<apos><space>in<space>s<space>and<space><apos>-<apos><space>in<space>s:<lf><space><space><space><space><space><space><space><space>isUTC<space>=<space>False<lf><space><space><space><space><space><space><space><space>if<space>s<openbracket>len<openparen>s<closeparen>-1<closebracket><space>==<space><apos>Z<apos>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>dateProps<space>=<space>map<openparen>int<comma><space>re.split<openparen><apos><openbracket>^<backslash>d<closebracket><apos><comma><space>s<openbracket>:-1<closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>isUTC<space>=<space>True<lf><space><space><space><space><space><space><space><space>else:<lf><space><space><space><space><space><space><space><space><space><space><space><space>dateProps<space>=<space>map<openparen>int<comma><space>re.split<openparen><apos><openbracket>^<backslash>d<closebracket><apos><comma><space>s<closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>if<space>len<openparen>dateProps<closeparen><space><lt><space>6:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>we<space>have<space>less<space>than<space>6<space>parsed<space>int<space>-<gt><space>does<space>not<space>make<space>an<space>iso<space>datetime<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>providedDate<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>has24HourFormat<space>=<space>False<lf><space><space><space><space><space><space><space><space>if<space>dateProps<openbracket>3<closebracket><space>==<space>24:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#later<space>add<space>one<space>day<space>as<space>offset<lf><space><space><space><space><space><space><space><space><space><space><space><space>dateProps<openbracket>3<closebracket><space>=<space>0<semicolon><lf><space><space><space><space><space><space><space><space><space><space><space><space>has24HourFormat<space>=<space>True<lf><lf><space><space><space><space><space><space><space><space>if<space>len<openparen>dateProps<closeparen><space>==<space>6:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#no<space>time<space>zone<lf><space><space><space><space><space><space><space><space><space><space><space><space>dateValue<space>=<space>datetime.datetime<openparen>*dateProps<closeparen><lf><space><space><space><space><space><space><space><space>elif<space>len<openparen>dateProps<closeparen><space>==<space>7:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#no<space>time<space>zone<comma><space>but<space>milliseconds<lf><space><space><space><space><space><space><space><space><space><space><space><space>dateValue<space>=<space>datetime.datetime<openparen>*dateProps<closeparen><lf><space><space><space><space><space><space><space><space>elif<space>len<openparen>dateProps<closeparen><space>==<space>8<space>or<space>len<openparen>dateProps<closeparen><space>==<space>9:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#time<space>zone<space>with<space>or<space>without<space>millis<space><openparen>the<space>last<space>two<space>int<space>represent<space>the<space>timezone<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>dateValue<space>=<space>datetime.datetime<openparen>*dateProps<openbracket>:-2<closebracket><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>#check<space>if<space>positive<space>or<space>negativ<space>offset<lf><space><space><space><space><space><space><space><space><space><space><space><space>sign<space>=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>s<openbracket>len<openparen>s<closeparen>-6<closebracket><space>==<space><apos>-<apos>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sign<space>=<space>-1<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>#create<space>datetime<space>with<space>a<space>timezone<space>object<lf><space><space><space><space><space><space><space><space><space><space><space><space>dateValue<space>=<space>dateValue.replace<openparen>tzinfo<space>=<space>ISO<openparen>datetime.timedelta<openparen>hours=sign*dateProps<openbracket>len<openparen>dateProps<closeparen>-2<closebracket><comma><space>minutes=sign*dateProps<openbracket>len<openparen>dateProps<closeparen>-1<closebracket><closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>else:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#nothing<space>worked<comma><space>return<space>original<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>providedDate<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>has24HourFormat:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>add<space>the<space>day<space><openparen>due<space>to<space>24:00:00<space>format<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>dateValue<space>=<space>dateValue<space>+<space>datetime.timedelta<openparen>days=1<closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#CONVERT<space>EVERYTHING<space>TO<space>UTC!<lf><space><space><space><space><space><space><space><space>if<space><openparen>dateValue.tzinfo<space>is<space>not<space>None<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>dateValue<space>=<space>dateValue.replace<openparen>tzinfo<space>=<space>None<closeparen><space>-<space>dateValue.tzinfo.utcoffset<openparen>dateValue<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#print<space>dateValue<lf><space><space><space><space><space><space><space><space>return<space>dateValue<lf><space><space><space><space><lf><space><space><space><space>else:<lf><space><space><space><space><space><space><space><space>#obviously<space>no<space>iso<space>datetime<lf><space><space><space><space><space><space><space><space>return<space>providedDate<lf><lf>def<space>processFeature<openparen>feature<closeparen>:<lf><space><space><space><space>att<space>=<space>feature.getAttribute<openparen><quote>_iso_datetime_object<quote><closeparen><lf><space><space><space><space>dto<space>=<space>feature.getAttribute<openparen>att<closeparen><lf><space><space><space><space><lf><space><space><space><space>if<space>dto<space>is<space>not<space>None:<lf><space><space><space><space><space><space><space><space>dto<space>=<space>parseISO8601Date<openparen>dto<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen>att<comma><space>str<openparen>dto<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space>return<space>feature<lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_ParseDateToUTC_OUTPUT"

# -------------------------------------------------------------------------

Tcl2 proc $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DateFormatter_formatter {invalidValue} {       set dateFormat {FME Date/Time (%Y%m%d%H%M%S)};       if { [string compare $dateFormat {FME Date/Time (%Y%m%d%H%M%S)}] == 0 } {          set dateFormat {%Y%m%d%H%M%S};       } elseif { [string compare $dateFormat {FME Date (%Y%m%d)}] == 0} {          set dateFormat {%Y%m%d};       } elseif { [string compare $dateFormat {FME Time (%H%M%S)}] == 0} {          set dateFormat {%H%M%S};       } elseif { [string compare $dateFormat {ISO Date (%Y-%m-%d)}] == 0} {          set dateFormat {%Y-%m-%d};       } elseif { [string compare $dateFormat {ISO DateTime (%Y-%m-%dT%H:%M:%S)}] == 0} {          set dateFormat {%Y-%m-%dT%H:%M:%S};       } elseif { [string compare $dateFormat {ISO Time (%H:%M:%S)}] == 0} {          set dateFormat {%H:%M:%S};       } elseif { [string compare $dateFormat {Locale Date (%c)}] == 0} {          set dateFormat {%c};       };     set attrs [split {$($(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DATETIME_ATTRIBUTE)} {,}];     foreach attr $attrs {        set date [string trim [FME_GetAttribute $attr]];        set dateLen [string length $date];        set srcfmt {};        if {{FME_AUTOMATIC} != {FME_AUTOMATIC}} {            set srcfmt {FME_AUTOMATIC};        };        if {$dateLen > 0} {           if {[string length $srcfmt] == 0} {              set attrFull $attr;              append attrFull .full;              set fullDate [FME_GetAttribute $attrFull];              if { [string compare -length $dateLen $date $fullDate] == 0 } {                 set extra [string range $fullDate $dateLen end]000000;                 set date [string range \"$date$extra\" 0 13];                 set dateLen 14              };              if {($dateLen == 14) && [regexp {^[0-9]*$} $date]} {                 set srcfmt %Y%m%d%H%M%S;              };           };        };        set sourceFormatOpt {};        if {[string length $srcfmt] > 0} {           set sourceFormatOpt \"-format {$srcfmt}\";        };        if { (0 == $dateLen) || [catch {                         set seconds [eval clock scan "{$date}" $sourceFormatOpt];                         FME_SetAttribute $attr [clock format $seconds -format $dateFormat];                          }] } {          if { $invalidValue == {FME_NULL_VALUE} } {             FME_SetAttributeNull $attr;          } elseif { $invalidValue != {_FME_NO_OP_} }  {             FME_SetAttribute $attr [FME_DecodeText $invalidValue];          };        };     }; }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DateFormatter    INPUT  FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_ParseDateToUTC_OUTPUT"    OUTPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DateFormatter_OUTPUT"         @Tcl2("$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DateFormatter_formatter {_FME_NO_OP_}")

# -------------------------------------------------------------------------

INCLUDE [    set macroLine "MACRO $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_RemoveTempAttribute_LIST_EXP ";    foreach attr [split ""] {       set attr [FME_DecodeText $attr];       set attr [regsub "{}$" $attr "{}.*"];       set attr [regsub -all "{}" $attr "{\[0-9\]+}"];       append macroLine ",^$attr$";    };    puts $macroLine; ]
FACTORY_DEF * TeeFactory    FACTORY_NAME $(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_RemoveTempAttribute    INPUT  FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_DateFormatter_OUTPUT"    OUTPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_RemoveTempAttribute_OUTPUT"        @RemoveAttributes(_iso_datetime_object)        @RemoveAttributes(fme_regexp_match"$($(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_RemoveTempAttribute_LIST_EXP)")

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_FeatureOut1421753849 Output Collector"   INPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_RemoveTempAttribute_OUTPUT"   OUTPUT FEATURE_TYPE "$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME)_FeatureOut"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(ConvertISO8601DateTimeToUTC_WORKSPACE_NAME))}]
