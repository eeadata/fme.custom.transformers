#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN TableauDownloadWorkbook,1,"Web Services",2e064d51-c8d8-433a-aeee-83c1bd848c1d,"Linked by Default",No,NO_PARALLELISM,,No,16492,YES,No
# <p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
#     <span style=" font-family:'Arial'; color:#323333;">Using the Tableau Server REST API, you can manage and change Tableau Server resources programmatically, via HTTP. The API gives you simple access to the functionality behind the data sources, projects, workbooks, site users, and sites on a Tableau server. You can use this access to create your own custom applications or to script interactions with Tableau Server resources.</span>
# </p>
# 
# TRANSFORMER_END
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   USAGE="&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;Tableau URI: &lt;/span&gt;Tableau server URI&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;Access token: &lt;/span&gt;Tableau access token retrieved from the TableauLogin transformer.&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;Site indentifier:&lt;/span&gt; Site identifier rececived from the TableauLogin transformer.&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;Workbook identifier: &lt;/span&gt;Workbook identifier to download.&lt;/p&gt;&#10;&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This transformer returns&lt;/p&gt;&#10;&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;workbook:&lt;/span&gt; Binary file&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-weight:600;&quot;&gt;workbook.filename: &lt;/span&gt;File name of the workbook. &lt;/p&gt;&#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   FME_DOCUMENT_GUID="2e064d51-c8d8-433a-aeee-83c1bd848c1d"
#!   DOC_TOP_LEFT="-620 -654.006"
#!   TITLE="TableauDownloadWorkbook"
#!   FME_PROCESS_GROUP_BY=""
#!   VIEW_POSITION="-1453.14 759.383"
#!   REQUIREMENTS_KEYWORD="none"
#!   BLOCKED_LOOPING="No"
#!   FME_SERVER_SERVICES=""
#!   ZOOM_SCALE="100"
#!   PASSWORD=""
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   DESCRIPTION="&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;span style=&quot; font-family:&apos;Arial&apos;; color:#323333;&quot;&gt;Using the Tableau Server REST API, you can manage and change Tableau Server resources programmatically, via HTTP. The API gives you simple access to the functionality behind the data sources, projects, workbooks, site users, and sites on a Tableau server. You can use this access to create your own custom applications or to script interactions with Tableau Server resources.&lt;/span&gt;&#10;&lt;/p&gt;&#10;"
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FME_LINKED_TRANSFORMER_VERSION="1"
#!   FME_BUILD_NUM="16492"
#!   FMX_INSERT_MODE="Linked by Default"
#!   SHOW_ANNOTATIONS="true"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   CATEGORY="Web Services"
#!   LEGAL_TERMS_CONDITIONS="&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;"
#!   LAST_SAVE_DATE="2016-07-05T11:08:31"
#!   ITERATION_COUNT_ATTR=""
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   WORKSPACE_VERSION="1"
#!   FME_DOCUMENT_PRIORGUID="f0c6ee79-dc72-4359-a850-72572027b8db"
#!   SHOW_INFO_NODES="true"
#!   HISTORY="22&lt;solidus&gt;June&lt;solidus&gt;2016,Jan&lt;space&gt;Bliki,First&lt;space&gt;creation"
#!   XFORM_DEPRECATED="No"
#!   DOC_EXTENTS="2995.02 742.882"
#!   ATTR_TYPE_ENCODING="SDF"
#!   REQUIREMENTS="&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&#10;    &lt;br/&gt;&#10;&lt;/p&gt;&#10;"
#!   LAST_SAVE_BUILD="FME(R) 2016.1.0.0 (20160419 - Build 16492 - WIN64)"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_NUM_OR_ATTR TABLEAUURI Tableau URI:"
#!   DEFAULT_VALUE="&lt;at&gt;Value&lt;openparen&gt;tableauURI&lt;closeparen&gt;"
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_NUM_OR_ATTR CREDENTIALS.TOKEN Access token:"
#!   DEFAULT_VALUE="&lt;at&gt;Value&lt;openparen&gt;credentials.token&lt;closeparen&gt;"
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_NUM_OR_ATTR SITE.ID Site identifier:"
#!   DEFAULT_VALUE="&lt;at&gt;Value&lt;openparen&gt;site.id&lt;closeparen&gt;"
#!   IS_STAND_ALONE="false"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_NUM_OR_ATTR WORKBOOK.ID Workbook identifier:"
#!   DEFAULT_VALUE="&lt;at&gt;Value&lt;openparen&gt;workbook.id&lt;closeparen&gt;"
#!   IS_STAND_ALONE="false"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! <BOOKMARK
#!   IDENTIFIER="16"
#!   NAME="Get filename"
#!   DESCRIPTION="&lt;html&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;"
#!   TOP_LEFT="563.003 88.8757"
#!   BOTTOM_RIGHT="2167.01 -654.006"
#!   BOUNDING_RECT="563.003 88.8757 1604.01 742.882"
#!   STICKY="true"
#!   COLOUR="0.458824,0.458824,0.976471"
#!   CONTENTS="18 17 23 14 13 19 22 21 25 10 20 "
#! />
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="1"
#!   TYPE="HTTPCaller"
#!   VERSION="1"
#!   POSITION="2.29375e-05 -5.54932e-06"
#!   BOUNDING_RECT="2.29375e-05 -5.54932e-06 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16494"
#! >
#!     <OUTPUT_FEAT NAME="Output"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;Rejected&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_error" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADDITIONAL_URL_PARAMETERS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ADDITIONAL_PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="AUTH_METHOD" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="VERIFY_SSL_CERTIFICATES" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="CUSTOM_HEADERS" PARM_VALUE="X-Tableau-Auth;&lt;at&gt;Value&lt;openparen&gt;credentials.token&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="ADVANCED_RESPONSE_PARAMETERS" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="UPLOAD_TYPE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="STATUS_CODE_ATTR" PARM_VALUE="_http_status_code"/>
#!     <XFORM_PARM PARM_NAME="ERROR_ATTR" PARM_VALUE="_error"/>
#!     <XFORM_PARM PARM_NAME="UPLOAD_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="CUSTOM_HEADERS_GROUP" PARM_VALUE="FME_DISCLOSURE_OPEN"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FILENAME" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="USE_COOKIES" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="HTTPCaller"/>
#!     <XFORM_PARM PARM_NAME="UPLOAD_FILE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="HTTPURL_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_DIRNAME" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="CONNECTION_TIMEOUT_LENGTH" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="TARGET_URL" PARM_VALUE="&lt;at&gt;Value&lt;openparen&gt;tableauURI&lt;closeparen&gt;api&lt;solidus&gt;2.2&lt;solidus&gt;sites&lt;solidus&gt;&lt;at&gt;Value&lt;openparen&gt;site.id&lt;closeparen&gt;&lt;solidus&gt;workbooks&lt;solidus&gt;&lt;at&gt;Value&lt;openparen&gt;workbook.id&lt;closeparen&gt;&lt;solidus&gt;content"/>
#!     <XFORM_PARM PARM_NAME="FILE_TYPE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="MULTIPART_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FILE_PATH_ATTR" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="FOLLOW_REDIRECTS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="AUTH_NAMED_CONNECTION" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="RESPONSE_HEADER_LIST_ATTR" PARM_VALUE="_headers"/>
#!     <XFORM_PARM PARM_NAME="HTTP_AUTH_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="MULTIPARTS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="RESPONSE_FILE_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="AUTH_PASSWORD" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ADVANCED_REQUEST_PARAMETERS" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="UPLOAD_CONTENT_TYPE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="UPLOAD_BODY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="SAVE_MULTI" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="AUTH_USERNAME" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TARGET_ATTR" PARM_VALUE="Workbook"/>
#!     <XFORM_PARM PARM_NAME="TARGET_ATTR_ENCODING" PARM_VALUE="fme-binary"/>
#!     <XFORM_PARM PARM_NAME="HTTP_RESPONSE_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HTTP_METHOD" PARM_VALUE="GET"/>
#!     <XFORM_PARM PARM_NAME="SAVE_FILE" PARM_VALUE="Attribute"/>
#!     <XFORM_PARM PARM_NAME="TRANSFER_TIMEOUT_LENGTH" PARM_VALUE="90"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="10"
#!   TYPE="ListSearcher"
#!   VERSION="5"
#!   POSITION="637.003 -19.5002"
#!   BOUNDING_RECT="637.003 -19.5002 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16494"
#! >
#!     <OUTPUT_FEAT NAME="FOUND"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="index_content" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_FOUND"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="LIST_ATTR" PARM_VALUE="_headers&lt;opencurly&gt;&lt;closecurly&gt;.name"/>
#!     <XFORM_PARM PARM_NAME="SEARCH_TYPE" PARM_VALUE="First exact match"/>
#!     <XFORM_PARM PARM_NAME="ATTR_VALUE" PARM_VALUE="Content-Disposition"/>
#!     <XFORM_PARM PARM_NAME="INDEX_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="PREFIX" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ListSearcher"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="INDEX_ATTR" PARM_VALUE="index_content"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="13"
#!   TYPE="ListIndexer"
#!   VERSION="2"
#!   POSITION="1165.51 -11.2501"
#!   BOUNDING_RECT="1165.51 -11.2501 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16494"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="index_content" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filevalue" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="index_content" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="filename" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="filevalue" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="INDEX" PARM_VALUE="@Value(index_content)"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTR" PARM_VALUE="_headers{}"/>
#!     <XFORM_PARM PARM_NAME="PREFIX" PARM_VALUE="file"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ListIndexer"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="17"
#!   TYPE="AttributeSplitter"
#!   VERSION="3"
#!   POSITION="1687.01 -19.1245"
#!   BOUNDING_RECT="1687.01 -19.1245 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16494"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="index_content" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filevalue" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_filevalue_list{}" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="DELIMITER" PARM_VALUE="&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="LIST_NAME" PARM_VALUE="_filevalue_list"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_NAME" PARM_VALUE="filevalue"/>
#!     <XFORM_PARM PARM_NAME="TRIM_OPTION" PARM_VALUE="Both"/>
#!     <XFORM_PARM PARM_NAME="DROP_EMPTY_PARTS" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AttributeSplitter"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="20"
#!   TYPE="AttributeCreator"
#!   VERSION="8"
#!   POSITION="663.748 -338.065"
#!   BOUNDING_RECT="663.748 -338.065 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16494"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="workbook_filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="index_content" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filevalue" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_filevalue_list{}" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_HANDLING" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="MULTI_FEATURE_MODE" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="NUM_SUBSEQUENT_FEATURES" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="ATTR_TABLE" PARM_VALUE="&quot;&quot; workbook_filename SET_TO &lt;at&gt;Value&lt;openparen&gt;_filevalue_list&lt;opencurly&gt;1&lt;closecurly&gt;&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="NUM_PRIOR_FEATURES" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AttributeCreator"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NULL_ATTR_MODE_DISPLAY" PARM_VALUE="No Substitution"/>
#!     <XFORM_PARM PARM_NAME="NULL_ATTR_VALUE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_GRP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="19"
#!   TYPE="StringReplacer"
#!   VERSION="4"
#!   POSITION="1214.13 -341.533"
#!   BOUNDING_RECT="1214.13 -341.533 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16494"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="workbook_filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="index_content" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filevalue" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_filevalue_list{}" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="FIND_TEXT" PARM_VALUE="filename="/>
#!     <XFORM_PARM PARM_NAME="NO_MATCH_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SRC_ATTRS" PARM_VALUE="workbook_filename"/>
#!     <XFORM_PARM PARM_NAME="REPLACE_TEXT" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="REGEXP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="StringReplacer"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NO_MATCH" PARM_VALUE="_FME_NO_OP_"/>
#!     <XFORM_PARM PARM_NAME="CASE" PARM_VALUE="NO"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="22"
#!   TYPE="AttributeTrimmer"
#!   VERSION="3"
#!   POSITION="1717.32 -340.268"
#!   BOUNDING_RECT="1717.32 -340.268 -1 -1"
#!   ORDER="5e+14"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="16494"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="workbook_filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="credentials.token" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="site.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_headers{}.value" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_http_status_code" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="index_content" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="filevalue" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="_filevalue_list{}" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="TRIM_TYPE" PARM_VALUE="Both"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SRC_ATTRS" PARM_VALUE="workbook_filename"/>
#!     <XFORM_PARM PARM_NAME="TRIM_CHARS" PARM_VALUE="&lt;quote&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRIM_TO_NONE" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AttributeTrimmer"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-620 -5.54932e-06"
#!   BOUNDING_RECT="-620 -5.54932e-06 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#!     <XFORM_ATTR ATTR_NAME="credentials.token" ATTR_VALUE="$(CREDENTIALS.TOKEN)" />
#!     <XFORM_ATTR ATTR_NAME="site.id" ATTR_VALUE="$(SITE.ID)" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" ATTR_VALUE="$(TABLEAUURI)" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" ATTR_VALUE="$(WORKBOOK.ID)" />
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="4"
#!   NAME="Output"
#!   POSITION="2375.02 -159.002"
#!   BOUNDING_RECT="2375.02 -159.002 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="1"
#! >
#!     <XFORM_ATTR ATTR_NAME="credentials.token" />
#!     <XFORM_ATTR ATTR_NAME="site.id" />
#!     <XFORM_ATTR ATTR_NAME="tableauURI" />
#!     <XFORM_ATTR ATTR_NAME="Workbook" />
#!     <XFORM_ATTR ATTR_NAME="workbook.id" />
#!     <XFORM_ATTR ATTR_NAME="workbook_filename" />
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="24"
#!   NAME="Failed"
#!   POSITION="-0.500245 -331.503"
#!   BOUNDING_RECT="-0.500245 -331.503 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="3"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="1"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="11"
#!   SOURCE_NODE="1"
#!   TARGET_NODE="10"
#!   SOURCE_PORT_DESC="fo 0 Output"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="14"
#!   SOURCE_NODE="10"
#!   TARGET_NODE="13"
#!   SOURCE_PORT_DESC="fo 0 FOUND"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="18"
#!   SOURCE_NODE="13"
#!   TARGET_NODE="17"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="17"
#!   TARGET_NODE="20"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="25"
#!   SOURCE_NODE="19"
#!   TARGET_NODE="22"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="23"
#!   SOURCE_NODE="20"
#!   TARGET_NODE="19"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="22"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="26"
#!   SOURCE_NODE="1"
#!   TARGET_NODE="24"
#!   SOURCE_PORT_DESC="fo 1 &lt;lt&gt;Rejected&lt;gt&gt;"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
DEFAULT_MACRO $(TableauDownloadWorkbook_WORKSPACE_NAME)_TABLEAUURI <at>Value<openparen>tableauURI<closeparen>
DEFAULT_MACRO $(TableauDownloadWorkbook_WORKSPACE_NAME)_CREDENTIALS.TOKEN <at>Value<openparen>credentials.token<closeparen>
DEFAULT_MACRO $(TableauDownloadWorkbook_WORKSPACE_NAME)_SITE.ID <at>Value<openparen>site.id<closeparen>
DEFAULT_MACRO $(TableauDownloadWorkbook_WORKSPACE_NAME)_WORKBOOK.ID <at>Value<openparen>workbook.id<closeparen>
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO TableauDownloadWorkbook_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(TableauDownloadWorkbook_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(TableauDownloadWorkbook_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Input1467709711 Input Splitter"   INPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Input" "@EvaluateExpression(ATTR_CREATE_EXPR_PROPAGATE_MISSING_FDIV,credentials.token,$($(TableauDownloadWorkbook_WORKSPACE_NAME)_CREDENTIALS.TOKEN),site.id,$($(TableauDownloadWorkbook_WORKSPACE_NAME)_SITE.ID),tableauURI,$($(TableauDownloadWorkbook_WORKSPACE_NAME)_TABLEAUURI),workbook.id,$($(TableauDownloadWorkbook_WORKSPACE_NAME)_WORKBOOK.ID), FEATURE_TYPE)"
# -------------------------------------------------------------------------

FACTORY_DEF * HTTPFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_HTTPCaller       INPUT  FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Input"    TARGET_URL "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>tableauURI<closeparen>api<solidus>2.2<solidus>sites<solidus><at>Value<openparen>site.id<closeparen><solidus>workbooks<solidus><at>Value<openparen>workbook.id<closeparen><solidus>content,$(TableauDownloadWorkbook_WORKSPACE_NAME)_HTTPCaller)"    HTTP_METHOD GET    SAVE_FILE NO    OUTPUT_FILENAME "<Unused>"    OUTPUT_DIRECTORY "<Unused>"    FILE_EXTENSION "<Unused>"    TARGET_ATTR "Workbook"    FILE_PATH_ATTR "<Unused>"    UPLOAD_FILE "<Unused>"    UPLOAD_BODY "<Unused>"    MULTIPART_UPLOAD <Unused>    UPLOAD_CONTENT_TYPE "<Unused>"    COMBINED_MULTIPART_TABLE    REQUEST_HEADER_TABLE X-Tableau-Auth;@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>credentials.token<closeparen>,$(TableauDownloadWorkbook_WORKSPACE_NAME)_HTTPCaller)    ADDITIONAL_URL_PARAMETERS    AUTH_USERNAME "<Unused>"    AUTH_PASSWORD "<Unused>"    AUTH_METHOD "<Unused>"    TARGET_ATTRIBUTE_ENCODING fme-binary    RESPONSE_HEADER_LIST_ATTR "_headers"    STATUS_CODE_ATTR "_http_status_code"    ERROR_ATTR "_error"    CONNECTION_TIMEOUT_LENGTH 60    TRANSFER_TIMEOUT_LENGTH 90    FOLLOW_REDIRECTS Yes    VERIFY_SSL_CERTIFICATES Yes    NAMED_CONNECTION "<Unused>"    USE_COOKIES No    OUTPUT OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_HTTPCaller_Output"    OUTPUT REJECTED FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_HTTPCaller_<Rejected>"

# -------------------------------------------------------------------------

# most of this is close to the code from listindexer but not exact beucase
# we have a type LIST_ATTR rather than type LIST_NAME so need
# to figure out the list name
Tcl2 proc $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30_indexer {index prefix} {    set fullListAttrName [FME_DecodeText _headers<opencurly><closecurly>.name];    set lastBrace [string last  \"{}\" $fullListAttrName];    set listAttr [string range $fullListAttrName 0 [expr $lastBrace+1]];    regsub \"{}\" $listAttr \"{$index}\" listWithIndex;    regsub \"{}\" $listAttr {} listBase;    set complexListExp "$listWithIndex\.";    set prefixLength [expr [string length $complexListExp]-1];    set prefix [FME_DecodeText $prefix];    foreach attr [FME_AttributeNames] {      set newAttr {};      if {$attr == $listWithIndex} {        set newAttr $listBase;      } elseif {[string first $complexListExp $attr] == 0} {        set newAttr [string replace $attr 0 $prefixLength];      };      if {$newAttr != {}} {          if {$prefix != {} } {            set newAttr $prefix$newAttr;          };          if {[string first {fme_} $newAttr] != 0} {              set first [string first {fme_} $newAttr];              lappend attrsToCopy $newAttr $attr;          };      };    };    if {[info exists attrsToCopy] && [llength $attrsToCopy] > 0} {      eval FME_Execute CopyAttributes $attrsToCopy;    }; }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher    INPUT  FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_HTTPCaller_Output"    OUTPUT FEATURE_TYPE $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher__IndexedFeatures___         "$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30" @SearchList(fme_encoded,"_headers<opencurly><closecurly>.name","Content-Disposition",FIRST_MATCHED_ENCODED)
FACTORY_DEF * TestFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher__Tester    INPUT FEATURE_TYPE $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher__IndexedFeatures___    TEST @Value($(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30) == "-1"    OUTPUT FAILED FEATURE_TYPE  $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher__IndexFound__
FACTORY_DEF * TestFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher__Tester2    INPUT FEATURE_TYPE $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher__IndexFound__    TEST NO == "NO"    OUTPUT PASSED FEATURE_TYPE  "$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_FOUND" @CopyAttributes(index_content, $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30) @RemoveAttributes($(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30)    OUTPUT FAILED FEATURE_TYPE  "$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_FOUND"  @Tcl2("$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30_indexer {@Value($(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30)} {<Unused>}") @CopyAttributes(index_content, $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30) @RemoveAttributes($(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_65003bfa_d1f7_4708_9366_59f231ac3dc30)

# -------------------------------------------------------------------------

Tcl2 proc $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_indexer {index numElements prefix} {    if {$index < 0 } {       set index [expr $numElements + $index];    };    regsub \"{}\" {_headers{}} \"{$index}\" listWithIndex;    regsub \"{}\" {_headers{}} {} listBase;    set complexListExp "$listWithIndex\.";    set prefixLength [expr [string length $complexListExp]-1];    set prefix [FME_DecodeText $prefix];    foreach attr [FME_AttributeNames] {      set newAttr {};      if {$attr == $listWithIndex} {        set newAttr $listBase;      } elseif {[string first $complexListExp $attr] == 0} {        set newAttr [string replace $attr 0 $prefixLength];      };      if {$newAttr != {}} {          if {$prefix != {} } {            set newAttr $prefix$newAttr;          };          if {[string first {fme_} $newAttr] != 0} {              set first [string first {fme_} $newAttr];              lappend attrsToCopy $newAttr $attr;          };      };    };    if {[info exists attrsToCopy] && [llength $attrsToCopy] > 0} {      eval FME_Execute CopyAttributes $attrsToCopy;    }; }
FACTORY_DEF * TestFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_IntTester    INPUT  FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListSearcher_FOUND"    TEST "@EvaluateExpression(FDIV,FLOAT,<at>Value<openparen>index_content<closeparen>,$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer)" TYPE INT ENCODED    OUTPUT PASSED FEATURE_TYPE __toOutput__
FACTORY_DEF * TestFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_ListIndexer    INPUT FEATURE_TYPE __toOutput__    TEST "@EvaluateExpression(FDIV,FLOAT,<at>Value<openparen>index_content<closeparen>,$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer)" >= 0    OUTPUT PASSED FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_OUTPUT" @Tcl2("$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_indexer @EvaluateExpression(FDIV,FLOAT,<at>Value<openparen>index_content<closeparen>,$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer) 0 {file}")    OUTPUT FAILED FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_OUTPUT" @Tcl2("$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_indexer @EvaluateExpression(FDIV,FLOAT,<at>Value<openparen>index_content<closeparen>,$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer) @NumElements(_headers{})  {file}")
# -------------------------------------------------------------------------

Tcl2 set $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_e35cb319_e653_49fc_a2bd_3900ad4ed92f0_splitDelim [FME_DecodeText {<semicolon>}];      if { [regexp {^([1-9][0-9]*s)+$} [set $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_e35cb319_e653_49fc_a2bd_3900ad4ed92f0_splitDelim]] }      {         set $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_e35cb319_e653_49fc_a2bd_3900ad4ed92f0_splitWidths [split [regsub -all {s$} {<semicolon>} {}] s];         proc $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_doSplit {}         {            global $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_e35cb319_e653_49fc_a2bd_3900ad4ed92f0_splitWidths;            set source [FME_GetAttribute [FME_DecodeText {filevalue}]];            set attrNum 0;            set listName [FME_DecodeText {_filevalue_list}];            set attrPos 0;            set keepEmptyParts [string equal {No} {No}];            foreach width [set $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_e35cb319_e653_49fc_a2bd_3900ad4ed92f0_splitWidths]            {               set endPos [expr $attrPos + $width - 1];               set bit [string range $source $attrPos $endPos];               set part [string trim $bit];               if { $keepEmptyParts || $part != \"\" } {                  FME_SetAttribute "$listName{$attrNum}" $part;                  incr attrNum;               };               incr attrPos $width;            };         };      }      else      {         proc $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_doSplit {}         {            global $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_e35cb319_e653_49fc_a2bd_3900ad4ed92f0_splitDelim;            set delim [set $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_e35cb319_e653_49fc_a2bd_3900ad4ed92f0_splitDelim];            set delimLength [string length $delim];            set source [FME_GetAttribute [FME_DecodeText {filevalue}]];            set keepEmptyParts [string equal {No} {No}];            set bits {};            set startIndex 0;            set nextIndex [string first $delim $source $startIndex];            while {$nextIndex >= 0} {              lappend bits [string range $source $startIndex [expr $nextIndex-1]];              set startIndex [expr $nextIndex + $delimLength];              set nextIndex [string first $delim $source $startIndex];            };            lappend bits [string range $source $startIndex end];            set listName [FME_DecodeText {_filevalue_list}];            set attrNum 0;            foreach bit $bits            {               set trimmedPart [string trim $bit];               if { $keepEmptyParts || $trimmedPart != \"\" } {                  FME_SetAttribute "$listName{$attrNum}" $trimmedPart;                  incr attrNum;               };            }          }       }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter    INPUT  FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_ListIndexer_OUTPUT"    OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_OUTPUT"         @Tcl2($(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_doSplit)

# -------------------------------------------------------------------------

FACTORY_DEF * AttrSetFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeCreator    INPUT  FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeSplitter_OUTPUT"    MULTI_FEATURE_MODE NO 	 NULL_ATTR_MODE NO_OP 	 ATTRSET_CREATE_DIRECTIVES _PROPAGATE_MISSING_FDIV 	 ATTR_ACTION "" "workbook_filename" "SET_TO" "<at>Value<openparen>_filevalue_list<opencurly>1<closecurly><closeparen>"    OUTPUT OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeCreator_OUTPUT"


# -------------------------------------------------------------------------

MACRO casemac
INCLUDE [ if { {NO} == {NO} } { puts {MACRO casemac -nocase}} ]
Tcl2 proc $(TableauDownloadWorkbook_WORKSPACE_NAME)_StringReplacer_a5228a58_774a_49c0_b01a_c6fc4b9cdfc80_replacer { findText replaceText invalidValue} {     set attrs [split \"workbook_filename\" {,}];     set findValue [FME_DecodeText $findText];     set replaceValue [FME_DecodeText $replaceText];     foreach attr $attrs {       set attrVal [FME_GetAttribute $attr];       set noMatch true;       if {{NO} == {YES}} {         set newAttrVal [FME_ReplaceRegex $(casemac) $findValue $attrVal $replaceValue];       } else {         set newAttrVal [string map $(casemac) [list $findValue $replaceValue] $attrVal];       };       if { $newAttrVal ne $attrVal } {         set noMatch false;         FME_SetAttribute $attr $newAttrVal;       };       if {$noMatch} {          if { $invalidValue == {FME_NULL_VALUE} } {             FME_SetAttributeNull $attr;          } elseif { $invalidValue != {_FME_NO_OP_} }  {             FME_SetAttribute $attr [FME_DecodeText $invalidValue];          };       };     }; }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_StringReplacer    INPUT  FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeCreator_OUTPUT"    OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_StringReplacer_OUTPUT"         @Tcl2("$(TableauDownloadWorkbook_WORKSPACE_NAME)_StringReplacer_a5228a58_774a_49c0_b01a_c6fc4b9cdfc80_replacer {filename=} {} {_FME_NO_OP_}")

# -------------------------------------------------------------------------

Tcl2 proc $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeTrimmer_40874efa_0167_4ff2_94fd_0f8f996c32540_trimmer { trimChars} {    set attrs [split {workbook_filename} {,}];    set trimChars [FME_DecodeText $trimChars];    foreach attr $attrs {       set attrVal [FME_GetAttribute $attr];       set length [string length $attrVal];       if {$length > 0} {          if {[string length $trimChars] == 0} {             set result [string trim $attrVal];         } else {             set result [string trim $attrVal $trimChars];         };          if {[string length $result] == 0 && {Yes} == {No}} {              if { {trim} == {trimleft}} {                set lastPos [expr $length - 1];                set result [string range $attrVal $lastPos $lastPos ];              } elseif { {trim} == {trimright}} {                set result [string range $attrVal 0 0];              } else {                set midPos [expr $length / 2];                set result [string range $attrVal $midPos $midPos];              };          };          FME_SetAttribute $attr $result;       };    }; }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeTrimmer    INPUT  FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_StringReplacer_OUTPUT"    OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeTrimmer_OUTPUT"      @Tcl2("$(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeTrimmer_40874efa_0167_4ff2_94fd_0f8f996c32540_trimmer {<quote>} ")

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Output1467709711 Output Collector"   INPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_AttributeTrimmer_OUTPUT"   OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Output" @RemoveAttributes(_http_status_code,index_content,filename,filevalue) @RemoveAttributes(fme_regexp_match,_headers{}.name,_headers{}.value,_filevalue_list{})
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Failed1467709711 Output Collector"   INPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_HTTPCaller_<Rejected>"   OUTPUT FEATURE_TYPE "$(TableauDownloadWorkbook_WORKSPACE_NAME)_Failed"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(TableauDownloadWorkbook_WORKSPACE_NAME))}]
